<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Zexin Wang">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.ico">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">[object Object]</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-Hot100-Day1" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2024/09/24/Hot100-Day1/" class="article-date">
  <time datetime="2024-09-24T14:37:49.877Z" itemprop="datePublished">2024-09-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="1-两数之和"><a target="_blank" rel="noopener" href="https://leetcode.cn/problems/two-sum/">1. 两数之和</a></h2>
<p><strong>示例 1：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">输入：nums = [2,7,11,15], target = 9</span><br><span class="line">输出：[0,1]</span><br><span class="line">解释：因为 nums[0] + nums[1] == 9 ，返回 [0, 1] 。</span><br></pre></td></tr></table></figure>
<p><strong>示例 2：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：nums = [3,2,4], target = 6</span><br><span class="line">输出：[1,2]</span><br></pre></td></tr></table></figure>
<p><strong>示例 3：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：nums = [3,3], target = 6</span><br><span class="line">输出：[0,1]</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>Note：</strong>$\textcolor{red}{这里返回的是数组下标}$</p>
</blockquote>
<p>拒绝暴力做法！</p>
<h3 id="解法1">解法1</h3>
<p>首先，我想先固定一个数，然后再用二分找另一个数。</p>
<p><code>截图</code></p>
<p>二分的前提是数字是有序的，因此需要先对数组进行排序。排序后数组下标就会乱了，所以需要将原本的数组构造成一个元组 <code>(index, number)</code> 。这里顺便复习了一下快排怎么写的，首先根据基准值划分区间，然后不断重复这个过程。</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">impl</span> Solution &#123;</span><br><span class="line">    <span class="keyword">pub</span> <span class="function"><span class="keyword">fn</span> <span class="title">two_sum</span></span>(<span class="keyword">mut</span> nums: <span class="built_in">Vec</span>&lt;<span class="built_in">i32</span>&gt;, <span class="keyword">mut</span> target: <span class="built_in">i32</span>) -&gt; <span class="built_in">Vec</span>&lt;<span class="built_in">i32</span>&gt; &#123;</span><br><span class="line">        <span class="comment">// 快排</span></span><br><span class="line">        <span class="keyword">let</span> n = nums.len();</span><br><span class="line">        <span class="keyword">let</span> <span class="keyword">mut</span> new_nums: <span class="built_in">Vec</span>&lt;(<span class="built_in">i32</span>, <span class="built_in">i32</span>)&gt; = nums.iter().enumerate().map(|(index, &amp;n)| (index <span class="keyword">as</span> <span class="built_in">i32</span>, n)).collect();</span><br><span class="line">        Self::quick_sort(&amp;<span class="keyword">mut</span> new_nums, <span class="number">0</span>, n - <span class="number">1</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 二分</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">0</span>..n - <span class="number">1</span> &#123;</span><br><span class="line">            <span class="keyword">let</span> tmp = target - new_nums[i].<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">let</span> (<span class="keyword">mut</span> l, <span class="keyword">mut</span> r) = (i + <span class="number">1</span>, n - <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">while</span> l &lt;= r &#123;</span><br><span class="line">                <span class="keyword">let</span> mid = l + (r - l) / <span class="number">2</span>;</span><br><span class="line">                <span class="keyword">if</span> new_nums[mid].<span class="number">1</span> &lt; tmp &#123;</span><br><span class="line">                    l = mid + <span class="number">1</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> new_nums[mid].<span class="number">1</span> &gt; tmp &#123;</span><br><span class="line">                    r = mid - <span class="number">1</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="built_in">vec!</span>[new_nums[i].<span class="number">0</span>, new_nums[mid].<span class="number">0</span>];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">vec!</span>[-<span class="number">1</span>, -<span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">pub</span> <span class="function"><span class="keyword">fn</span> <span class="title">quick_sort</span></span>(nums: &amp;<span class="keyword">mut</span> <span class="built_in">Vec</span>&lt;(<span class="built_in">i32</span>, <span class="built_in">i32</span>)&gt;, left: <span class="built_in">usize</span>, right: <span class="built_in">usize</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> left &lt; right &#123;</span><br><span class="line">            <span class="keyword">let</span> base = Self::partation(nums, left, right);</span><br><span class="line">            <span class="keyword">if</span> base &gt; <span class="number">0</span> &#123;</span><br><span class="line">                Self::quick_sort(nums, left, base - <span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            Self::quick_sort(nums, base + <span class="number">1</span>, right);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">pub</span> <span class="function"><span class="keyword">fn</span> <span class="title">partation</span></span>(nums: &amp;<span class="keyword">mut</span> <span class="built_in">Vec</span>&lt;(<span class="built_in">i32</span>, <span class="built_in">i32</span>)&gt;, left: <span class="built_in">usize</span>, right: <span class="built_in">usize</span>) -&gt; <span class="built_in">usize</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="keyword">mut</span> tmp = left;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> (<span class="keyword">mut</span> l, <span class="keyword">mut</span> r) = (left, right);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> l &lt; r &#123;</span><br><span class="line">            <span class="keyword">while</span> l &lt; r &amp;&amp; nums[r].<span class="number">1</span> &gt;= nums[tmp].<span class="number">1</span> &#123;</span><br><span class="line">                r -= <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">while</span> l &lt; r &amp;&amp; nums[l].<span class="number">1</span> &lt;= nums[tmp].<span class="number">1</span> &#123;</span><br><span class="line">                l += <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> l != r &#123;</span><br><span class="line">                nums.swap(l, r);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        nums.swap(l, tmp);</span><br><span class="line"></span><br><span class="line">        l</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>空间复杂度：<code>O(n)</code></p>
<p>时间复杂度：<code>O(nlogn)</code> 取决于你使用的排序算法，这里我用的是快排。然而，如果不存在 <code>nums[i] +  nums[j] = target </code> ，需要执行<code>n-1</code> 次二分，时间复杂度退化为 <code>O(n^2)</code>。</p>
<h3 id="解法2">解法2</h3>
<p>会不会发现用二分其实有点多余了？那么我能不能再缩小一下搜索范围呢？显然是可以的，我们还可以用双指针的做法，如公式1所示。<br>
$$<br>
nums[l] + nums[r] &lt; target \ \ =&gt; \ \ l  = l+1 \<br>
nums[l] + nums[r] &gt; target \ \ =&gt; \ \ r  = r-1 \tag{1}<br>
$$</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">impl</span> Solution &#123;</span><br><span class="line">    <span class="keyword">pub</span> <span class="function"><span class="keyword">fn</span> <span class="title">two_sum</span></span>(<span class="keyword">mut</span> nums: <span class="built_in">Vec</span>&lt;<span class="built_in">i32</span>&gt;, target: <span class="built_in">i32</span>) -&gt; <span class="built_in">Vec</span>&lt;<span class="built_in">i32</span>&gt; &#123;</span><br><span class="line">        <span class="keyword">if</span> nums.len() &lt;= <span class="number">1</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">Vec</span>::&lt;<span class="built_in">i32</span>&gt;::new();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">let</span> <span class="keyword">mut</span> number: <span class="built_in">Vec</span>&lt;_&gt; = nums.into_iter().enumerate()</span><br><span class="line">                    .map(|(i, n)| (i <span class="keyword">as</span> <span class="built_in">i32</span>, n))</span><br><span class="line">                    .collect();</span><br><span class="line">        </span><br><span class="line">        number.sort_by_key(|(_, n)| *n);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> (<span class="keyword">mut</span> l, <span class="keyword">mut</span> r) = (<span class="number">0</span>, number.len() - <span class="number">1</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">while</span> l &lt; r &#123;</span><br><span class="line">            <span class="keyword">if</span> number[l].<span class="number">1</span> + number[r].<span class="number">1</span> &gt; target &#123;</span><br><span class="line">                r -= <span class="number">1</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> number[l].<span class="number">1</span> + number[r].<span class="number">1</span> &lt; target &#123;</span><br><span class="line">                l += <span class="number">1</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="built_in">vec!</span>[number[l].<span class="number">0</span>, number[r].<span class="number">0</span>];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">vec!</span>[-<span class="number">1</span>, -<span class="number">1</span>]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>空间复杂度：<code>O(n)</code></p>
<p>时间复杂度：<code>O(nlogn)</code></p>
<h3 id="解法3">解法3</h3>
<p>前两个是我自己能够想到除暴力以外的最简便方法了，看完官方题解后，忽然发现自己真的有点愚蠢了…同样需要消耗额外空间，为什么不用搜索效率更高的数据结构呢？显然哈希表就是一个很好的解决方案。</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> std::collections::HashMap;</span><br><span class="line"><span class="keyword">impl</span> Solution &#123;</span><br><span class="line">    <span class="keyword">pub</span> <span class="function"><span class="keyword">fn</span> <span class="title">two_sum</span></span>(nums: <span class="built_in">Vec</span>&lt;<span class="built_in">i32</span>&gt;, target: <span class="built_in">i32</span>) -&gt; <span class="built_in">Vec</span>&lt;<span class="built_in">i32</span>&gt; &#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="keyword">mut</span> M = HashMap::new();</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> (idx, &amp;n) <span class="keyword">in</span> nums.iter().enumerate() &#123;</span><br><span class="line">            <span class="keyword">if</span> M.contains_key(&amp;(target - n)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="built_in">vec!</span>[*M.get(&amp;(target - n)).unwrap(), idx <span class="keyword">as</span> <span class="built_in">i32</span>];</span><br><span class="line">            &#125;</span><br><span class="line">            M.insert(n, idx <span class="keyword">as</span> <span class="built_in">i32</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">vec!</span>[-<span class="number">1</span>, -<span class="number">1</span>]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>空间复杂度：<code>O(n)</code></p>
<p>时间复杂度：<code>O(n)</code></p>
<h2 id="49-字母异位词分组"><a target="_blank" rel="noopener" href="https://leetcode.cn/problems/group-anagrams/">49. 字母异位词分组</a></h2>
<p><strong>示例 1:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入: strs = [&quot;eat&quot;, &quot;tea&quot;, &quot;tan&quot;, &quot;ate&quot;, &quot;nat&quot;, &quot;bat&quot;]</span><br><span class="line">输出: [[&quot;bat&quot;],[&quot;nat&quot;,&quot;tan&quot;],[&quot;ate&quot;,&quot;eat&quot;,&quot;tea&quot;]]</span><br></pre></td></tr></table></figure>
<p><strong>示例 2:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入: strs = [&quot;&quot;]</span><br><span class="line">输出: [[&quot;&quot;]]</span><br></pre></td></tr></table></figure>
<p><strong>示例 3:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入: strs = [&quot;a&quot;]</span><br><span class="line">输出: [[&quot;a&quot;]]</span><br></pre></td></tr></table></figure>
<h3 id="解法1-2">解法1</h3>
<p>由于字符串不像数字一样可以当作数组下标，例如：<code>1</code> 可以放在 <code>nums[1]</code> 位置，判断一个数字是否已经存在，可以判断 <code>nums[nums[i]]</code> 是否存在。但是，我们可以将字符转化为数字，同时为了保证字符串的唯一性，也就是不能一个数字同时表示 <code>abc</code> 和 <code>abd</code> 。互质的数字可以帮我们解决这个问题，不会出现 <code>a*b mod c = 0</code>。因此，我们可以将 26 个英文字母用 26 个互质的数表示。大多数情况下，用下标映射的方式难以预测要开辟的数组大小，容易产生爆栈。因此，我们需要将其离散化，也就是用 <code>HashMap</code> 来存储。$\textcolor{red}{字符串用每个字符映射到的素数相乘，需要用\ u128 \ 类型记录乘积，否则会出现溢出的问题。}$</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> std::collections::HashMap;</span><br><span class="line"><span class="keyword">impl</span> Solution &#123;</span><br><span class="line">    <span class="keyword">const</span> words: [<span class="built_in">u128</span>;<span class="number">26</span>] = [<span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span> , <span class="number">11</span>, <span class="number">13</span>, <span class="number">17</span>, <span class="number">19</span>, <span class="number">23</span>, <span class="number">29</span>, <span class="number">31</span>, <span class="number">37</span>, <span class="number">41</span>, <span class="number">43</span>, <span class="number">47</span>, <span class="number">53</span>, <span class="number">59</span>, <span class="number">61</span>, <span class="number">67</span>, <span class="number">71</span>, <span class="number">73</span>, <span class="number">79</span>, <span class="number">83</span>, <span class="number">89</span>, <span class="number">97</span>, <span class="number">101</span>];</span><br><span class="line">    <span class="keyword">pub</span> <span class="function"><span class="keyword">fn</span> <span class="title">group_anagrams</span></span>(<span class="keyword">mut</span> strs: <span class="built_in">Vec</span>&lt;<span class="built_in">String</span>&gt;) -&gt; <span class="built_in">Vec</span>&lt;<span class="built_in">Vec</span>&lt;<span class="built_in">String</span>&gt;&gt; &#123;</span><br><span class="line">        strs.into_iter().fold(HashMap::&lt;_, <span class="built_in">Vec</span>&lt;<span class="built_in">String</span>&gt;&gt;::new(), |<span class="keyword">mut</span> maps, s| &#123;</span><br><span class="line">            maps.entry(s.chars().fold(<span class="number">1</span>, |p, c| p * Self::words[(c <span class="keyword">as</span> <span class="built_in">u8</span> - <span class="string">b&#x27;a&#x27;</span>)  <span class="keyword">as</span> <span class="built_in">usize</span>]))</span><br><span class="line">            .and_modify(|v| v.push(s.clone()))</span><br><span class="line">            .or_insert_with(|| <span class="built_in">vec!</span>[s.clone()]);</span><br><span class="line">            maps</span><br><span class="line">        &#125;)</span><br><span class="line">        .drain()</span><br><span class="line">        .map(|(_, v)| v)</span><br><span class="line">        .collect()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="解法2-2">解法2</h3>
<p>使用哈希表的时候，以排序后的字符串为 <code>key</code>，异位词数组为 <code>value</code>。</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> std::collections::HashMap;</span><br><span class="line"><span class="keyword">impl</span> Solution &#123;</span><br><span class="line">    <span class="keyword">pub</span> <span class="function"><span class="keyword">fn</span> <span class="title">group_anagrams</span></span>(<span class="keyword">mut</span> strs: <span class="built_in">Vec</span>&lt;<span class="built_in">String</span>&gt;) -&gt; <span class="built_in">Vec</span>&lt;<span class="built_in">Vec</span>&lt;<span class="built_in">String</span>&gt;&gt; &#123;</span><br><span class="line">        strs.into_iter().fold(HashMap::&lt;<span class="built_in">String</span>, <span class="built_in">Vec</span>&lt;<span class="built_in">String</span>&gt;&gt;::new(), |<span class="keyword">mut</span> maps, s| &#123;</span><br><span class="line">            <span class="keyword">let</span> <span class="keyword">mut</span> tmp = s.clone().into_bytes();</span><br><span class="line">            tmp.sort_unstable();</span><br><span class="line">            maps.entry(<span class="built_in">String</span>::from_utf8(tmp).unwrap())</span><br><span class="line">            .or_insert(<span class="built_in">vec!</span>[])</span><br><span class="line">            .push(s);</span><br><span class="line">            maps</span><br><span class="line">        &#125;)</span><br><span class="line">        .drain()</span><br><span class="line">        .map(|(_, v)| v)</span><br><span class="line">        .collect()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这里的迭代器操作是真的厉害，唯一一点就是太难记住了，各种堆叠操作。</p>
<h2 id="128-最长连续序列"><a target="_blank" rel="noopener" href="https://leetcode.cn/problems/longest-consecutive-sequence/">128. 最长连续序列</a></h2>
<p>给定一个未排序的整数数组 <code>nums</code> ，找出数字连续的最长序列（不要求序列元素在原数组中连续）的长度。</p>
<p>请你设计并实现时间复杂度为 <code>O(n)</code> 的算法解决此问题。</p>
<p><strong>示例 1：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">输入：nums = [100,4,200,1,3,2]</span><br><span class="line">输出：4</span><br><span class="line">解释：最长数字连续序列是 [1, 2, 3, 4]。它的长度为 4。</span><br></pre></td></tr></table></figure>
<p><strong>示例 2：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：nums = [0,3,7,2,5,8,4,6,0,1]</span><br><span class="line">输出：9</span><br></pre></td></tr></table></figure>
<h3 id="解法1-3">解法1</h3>
<p>这个题刚开始的思路是存在数组里面，判断当前数的前一个是否存在。但是这个数没有固定的大小，最少需要开 $10^9$ 。到头来还是得用哈希表存，以后一定要记住用哈希表存离散化的数据！用 <code>HashMap</code>有点浪费空间，改用<code>HashSet</code>来存。遍历的时候，如果存在当前数字的前一个数字，即：$nums[i-1]$，那么我们需要跳过它，因为在计算$nums[i - 1]$ 的时候已经计算过 $nums[i]$ 组成的最长子序列了。根据这个思想，我们只需要找到每个子序列的开始数字，然后向后找，避免冗余的计算。</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> std::collections::HashSet;</span><br><span class="line"><span class="keyword">impl</span> Solution &#123;</span><br><span class="line">    <span class="keyword">pub</span> <span class="function"><span class="keyword">fn</span> <span class="title">longest_consecutive</span></span>(nums: <span class="built_in">Vec</span>&lt;<span class="built_in">i32</span>&gt;) -&gt; <span class="built_in">i32</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="keyword">mut</span> sets = HashSet::new();</span><br><span class="line">        <span class="keyword">let</span> <span class="keyword">mut</span> res = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> &amp;n <span class="keyword">in</span> nums.iter() &#123;</span><br><span class="line">            sets.insert(n);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> n <span class="keyword">in</span> nums &#123;</span><br><span class="line">            <span class="keyword">let</span> <span class="keyword">mut</span> num = n;</span><br><span class="line">            <span class="keyword">if</span> !sets.contains(&amp;(n - <span class="number">1</span>)) &#123;</span><br><span class="line">                <span class="keyword">while</span> sets.contains(&amp;(num + <span class="number">1</span>)) &#123;</span><br><span class="line">                    num += <span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            res = res.max(num - n + <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        res</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="解法2-3">解法2</h3>
<p>将数字当作图的点，将相邻的数直接存在边，用并查集计算连通分量。这里并查集也不能用数组了，需要用<code>HashMap</code>来处理离散化的数据。哈希表的并查集不是很容易写的，需要注意在连接的时候在哈希表中插入自己到自己的连通关系。</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> std::collections::HashMap;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ST</span></span> &#123;</span><br><span class="line">    parent: HashMap&lt;<span class="built_in">i32</span>, <span class="built_in">i32</span>&gt;,</span><br><span class="line">    size: HashMap&lt;<span class="built_in">i32</span>, <span class="built_in">i32</span>&gt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">impl</span> ST &#123;</span><br><span class="line">    <span class="function"><span class="keyword">fn</span> <span class="title">new</span></span>() -&gt; ST &#123;</span><br><span class="line">        ST &#123;</span><br><span class="line">            parent: HashMap::new(),</span><br><span class="line">            size: HashMap::new(),</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">fn</span> <span class="title">find</span></span>(&amp;<span class="keyword">mut</span> <span class="keyword">self</span>, x: <span class="built_in">i32</span>) -&gt; <span class="built_in">i32</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">self</span>.parent[&amp;x] != x &#123;</span><br><span class="line">            <span class="keyword">let</span> p = <span class="keyword">self</span>.find(<span class="keyword">self</span>.parent[&amp;x]);</span><br><span class="line">            <span class="keyword">self</span>.parent.insert(x, p);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">self</span>.parent[&amp;x]</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">fn</span> <span class="title">union</span></span>(&amp;<span class="keyword">mut</span> <span class="keyword">self</span>, x: <span class="built_in">i32</span>, y: <span class="built_in">i32</span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> x = <span class="keyword">self</span>.find(x);</span><br><span class="line">        <span class="keyword">let</span> y = <span class="keyword">self</span>.find(y);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> x == y &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">self</span>.size[&amp;x] &gt; <span class="keyword">self</span>.size[&amp;y] &#123;</span><br><span class="line">            *<span class="keyword">self</span>.parent.get_mut(&amp;x).unwrap() = y;</span><br><span class="line">            *<span class="keyword">self</span>.size.get_mut(&amp;y).unwrap() += <span class="keyword">self</span>.size[&amp;x];</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            *<span class="keyword">self</span>.parent.get_mut(&amp;y).unwrap() = x;</span><br><span class="line">            *<span class="keyword">self</span>.size.get_mut(&amp;x).unwrap() += <span class="keyword">self</span>.size[&amp;y];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">impl</span> Solution &#123;</span><br><span class="line">    <span class="keyword">pub</span> <span class="function"><span class="keyword">fn</span> <span class="title">longest_consecutive</span></span>(nums: <span class="built_in">Vec</span>&lt;<span class="built_in">i32</span>&gt;) -&gt; <span class="built_in">i32</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> nums.len() == <span class="number">0</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">let</span> <span class="keyword">mut</span> st = ST::new();</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">0</span>..nums.len() &#123;</span><br><span class="line">            st.parent.insert(nums[i], nums[i]);</span><br><span class="line">            st.size.insert(nums[i], <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">0</span>..nums.len() &#123;</span><br><span class="line">            <span class="keyword">if</span> st.parent.contains_key(&amp;(nums[i] + <span class="number">1</span>)) &#123;</span><br><span class="line">                st.union(nums[i] + <span class="number">1</span>, nums[i])</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; </span><br><span class="line"></span><br><span class="line">        st.size.drain().max_by(|(_, v1), (_, v2)| v1.cmp(v2)).unwrap().<span class="number">1</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="283-移动零"><a target="_blank" rel="noopener" href="https://leetcode.cn/problems/move-zeroes/">283. 移动零</a></h2>
<p>给定一个数组 <code>nums</code>，编写一个函数将所有 <code>0</code> 移动到数组的末尾，同时保持非零元素的相对顺序。</p>
<p><strong>请注意</strong> ，必须在不复制数组的情况下原地对数组进行操作。</p>
<p><strong>示例 1:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入: nums = [0,1,0,3,12]</span><br><span class="line">输出: [1,3,12,0,0]</span><br></pre></td></tr></table></figure>
<p><strong>示例 2:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入: nums = [0]</span><br><span class="line">输出: [0]</span><br></pre></td></tr></table></figure>
<p><strong>提示</strong>:</p>
<ul>
<li><code>1 &lt;= nums.length &lt;= 104</code></li>
<li><code>-231 &lt;= nums[i] &lt;= 231 - 1</code></li>
</ul>
<p>**进阶：**你能尽量减少完成的操作次数吗？</p>
<p>这道题需要注意的是不能改变原本数字的顺序，因此不能用排序。暴力的做法就是新开一个同样大小的数组，然后</p>
<h3 id="解法1-4">解法1</h3>
<p>快慢指针，快指针用来遍历每个数字，慢指针用来指向非<code>0</code>数字要放入的位置。</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">impl</span> Solution &#123;</span><br><span class="line">    <span class="keyword">pub</span> <span class="function"><span class="keyword">fn</span> <span class="title">move_zeroes</span></span>(nums: &amp;<span class="keyword">mut</span> <span class="built_in">Vec</span>&lt;<span class="built_in">i32</span>&gt;) &#123;</span><br><span class="line">        <span class="keyword">let</span> (<span class="keyword">mut</span> l, <span class="keyword">mut</span> r) = (<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> r &lt; nums.len() &#123;</span><br><span class="line">            <span class="keyword">if</span> nums[r] == <span class="number">0</span> &#123;</span><br><span class="line">                r += <span class="number">1</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                nums.swap(r, l);</span><br><span class="line">                r += <span class="number">1</span>;</span><br><span class="line">                l += <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="解法2-4">解法2</h3>
<p>用迭代器把<code>0</code>过滤掉，然后在后面放入0。不得不说调API真是太方便辣，只是记不住这么多函数。</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">impl</span> Solution &#123;</span><br><span class="line">    <span class="keyword">pub</span> <span class="function"><span class="keyword">fn</span> <span class="title">move_zeroes</span></span>(<span class="keyword">mut</span> nums: &amp;<span class="keyword">mut</span> <span class="built_in">Vec</span>&lt;<span class="built_in">i32</span>&gt;) &#123;</span><br><span class="line">        <span class="keyword">let</span> n = nums.len();</span><br><span class="line">        nums.retain(|&amp;x| x != <span class="number">0</span>);</span><br><span class="line">        nums.resize(n, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="11-盛最多水的容器"><a target="_blank" rel="noopener" href="https://leetcode.cn/problems/container-with-most-water/">11. 盛最多水的容器</a></h2>
<p><img src="Hot100-Day1%5Clc11.png" alt=""></p>
<blockquote>
<p>输入：[1,8,6,2,5,4,8,3,7]<br>
输出：49<br>
解释：图中垂直线代表输入数组 [1,8,6,2,5,4,8,3,7]。在此情况下，容器能够容纳水（表示为蓝色部分）的最大值为 49。</p>
</blockquote>
<h3 id="解法1（超时）">解法1（超时）</h3>
<p>木桶效应原理的题目，容量取决于短板的长度。暴力的枚举每个区间，每次取两边的最小值和区间大小相乘求得面积。</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">impl</span> Solution &#123;</span><br><span class="line">    <span class="keyword">pub</span> <span class="function"><span class="keyword">fn</span> <span class="title">max_area</span></span>(height: <span class="built_in">Vec</span>&lt;<span class="built_in">i32</span>&gt;) -&gt; <span class="built_in">i32</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> (<span class="keyword">mut</span> res, <span class="keyword">mut</span> maxh) = (<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">0</span>..height.len() &#123;</span><br><span class="line">            maxh = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> i + <span class="number">1</span>..height.len() &#123;</span><br><span class="line">                res = res.max(height[j].min(height[i]) * (j - i) <span class="keyword">as</span> <span class="built_in">i32</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        res</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="解法2-5">解法2</h3>
<p>双指针分别指向数组的最左侧和最右侧。首先，我们思考一个规律，两边木板最短的不变，另一侧就算长度为无穷，区间长度 $j-i$ 减小了，面积应该也减小。因此，我们需要调整最短一侧的指针向内收缩，优化不必要的计算开销。<br>
$$<br>
S(i, j) &gt; S(i, j-1)&gt;S(i,j-2)··&gt; S(i,i+1) \ \ \ \ height[i] &lt; height[j] \<br>
S(i, j) &gt; S(i+1, j)&gt;S(i+2,j)··&gt;S(j-1,j) \ \ \ \ height[i] &gt; height[j] \<br>
S=min(height[i], height[j])*(j - i)<br>
$$</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">impl</span> Solution &#123;</span><br><span class="line">    <span class="keyword">pub</span> <span class="function"><span class="keyword">fn</span> <span class="title">max_area</span></span>(height: <span class="built_in">Vec</span>&lt;<span class="built_in">i32</span>&gt;) -&gt; <span class="built_in">i32</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> (<span class="keyword">mut</span> left, <span class="keyword">mut</span> right) = (<span class="number">0</span>, height.len() - <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">let</span> <span class="keyword">mut</span> res = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> left &lt; right &#123;</span><br><span class="line">            res = res.max(height[left].min(height[right]) * (right - left) <span class="keyword">as</span> <span class="built_in">i32</span>);</span><br><span class="line">            <span class="keyword">if</span> height[left] &lt; height[right] &#123;</span><br><span class="line">                left += <span class="number">1</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                right -= <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        res</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="15-三数之和"><a target="_blank" rel="noopener" href="https://leetcode.cn/problems/3sum/">15. 三数之和</a></h2>
<p>给你一个整数数组 <code>nums</code> ，判断是否存在三元组 <code>[nums[i], nums[j], nums[k]]</code> 满足 <code>i != j</code>、<code>i != k</code> 且 <code>j != k</code> ，同时还满足 <code>nums[i] + nums[j] + nums[k] == 0</code> 。请你返回所有和为 <code>0</code> 且$\textcolor{red}{不重复}$的三元组。</p>
<blockquote>
<p>输入：nums = [-1,0,1,2,-1,-4]<br>
输出：[[-1,-1,2],[-1,0,1]]<br>
解释：<br>
nums[0] + nums[1] + nums[2] = (-1) + 0 + 1 = 0 。<br>
nums[1] + nums[2] + nums[4] = 0 + 1 + (-1) = 0 。<br>
nums[0] + nums[3] + nums[4] = (-1) + 2 + (-1) = 0 。<br>
不同的三元组是 [-1,0,1] 和 [-1,-1,2] 。</p>
</blockquote>
<p>其实就是给一个数组，然后找到三个数的和等于<code>0</code>，而且这三个数组成的三元组不能重复的问题。显然，三层循环暴力遍历能够得到答案，但是必定会超时。</p>
<p>我的想法是，固定一个数，然后双指针。（又回到了第一题的思路）看着很简单，但是还有很多细节需要注意，还是看了别人的题解才写出来的。</p>
<p>（1）如何保证不出现重复的三元组？</p>
<p>例如，给定数组 $[-1, -1, -1, 0, 1, 1, 2]$，我们应该得到 $[-1,0,1]$和 $[-1,-1,2]$。通过观察，我们可以发现前三个 $-1$ 作为固定的第一个数得到的三元组是一样的，因此我们 $nums[i] = nums[i - 1]$ 的时候，我们就跳过 $nums[i]$ 这样就不会重复计算。那为什么不能按照 $nums[i+1] = nums[i]$ 的规律跳过呢？（我踩过的坑）这样会出现的问题就是不能组成 $[-1,-1,2]$ 了？</p>
<p>（2）如何保证双指针找 $target$ 的时候不出现重复的二元组？</p>
<p>这种情况下，我们需要跳过重复的数字。也就是在找到两个数的和为 $target$ 的时候，两个指针向内收缩，分别收缩到和已经得到的结果不一样的数字，即 $nums[left] = nums[left - 1]$ 和 $nums[right] = nums[right + 1]$ 这两种判断来去重双指针的重复结果。</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">impl</span> Solution &#123;</span><br><span class="line">    <span class="keyword">pub</span> <span class="function"><span class="keyword">fn</span> <span class="title">three_sum</span></span>(nums: <span class="built_in">Vec</span>&lt;<span class="built_in">i32</span>&gt;) -&gt; <span class="built_in">Vec</span>&lt;<span class="built_in">Vec</span>&lt;<span class="built_in">i32</span>&gt;&gt; &#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="keyword">mut</span> res: <span class="built_in">Vec</span>&lt;<span class="built_in">Vec</span>&lt;<span class="built_in">i32</span>&gt;&gt; = <span class="built_in">Vec</span>::&lt;<span class="built_in">Vec</span>&lt;<span class="built_in">i32</span>&gt;&gt;::new();</span><br><span class="line">        <span class="keyword">let</span> <span class="keyword">mut</span> arrs: <span class="built_in">Vec</span>&lt;<span class="built_in">i32</span>&gt; = nums.clone();</span><br><span class="line">        arrs.sort(); <span class="comment">// 排序</span></span><br><span class="line">        <span class="comment">// println!(&quot;&#123;:?&#125;&quot;, arrs);</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">0</span>..arrs.len() -<span class="number">2</span> &#123; <span class="comment">// 从开始固定一个数字，只能到倒数第三个数字</span></span><br><span class="line">            <span class="keyword">if</span> arrs[i] &gt; <span class="number">0</span> &#123; <span class="comment">// 因为是排序的数组，所以当前数字大于0，后面也都没办法满足三数和是0</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> (i &gt; <span class="number">0</span> &amp;&amp; arrs[i] == arrs[i - <span class="number">1</span>]) &#123; <span class="comment">// 排除重复结果</span></span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">let</span> traget = -arrs[i];</span><br><span class="line">            <span class="keyword">let</span> <span class="keyword">mut</span> left = i + <span class="number">1</span>; <span class="comment">// 左指针</span></span><br><span class="line">            <span class="keyword">let</span> <span class="keyword">mut</span> right = arrs.len() - <span class="number">1</span>; <span class="comment">// 右指针</span></span><br><span class="line">            </span><br><span class="line">            <span class="keyword">while</span> left &lt; right &#123; <span class="comment">// 类似二分？</span></span><br><span class="line">                <span class="keyword">let</span> sum = arrs[i] + arrs[left] + arrs[right];</span><br><span class="line">                <span class="comment">// println!(&quot;&#123;:?&#125;&quot;, sum);</span></span><br><span class="line">                <span class="keyword">if</span> sum &lt; <span class="number">0</span> &#123; <span class="comment">// 加起来小于原来的数，左指针向右移动</span></span><br><span class="line">                    left += <span class="number">1</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> sum &gt; <span class="number">0</span> &#123; <span class="comment">// 加起来大于原来的数，右指针向左移动</span></span><br><span class="line">                    right -= <span class="number">1</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    res.push(<span class="built_in">vec!</span>[arrs[i], arrs[left], arrs[right]]);</span><br><span class="line">                    left += <span class="number">1</span>;</span><br><span class="line">                    right -= <span class="number">1</span>;</span><br><span class="line">                    <span class="keyword">while</span> left &lt; right &amp;&amp; arrs[left] == arrs[left - <span class="number">1</span>] &#123; left += <span class="number">1</span>; &#125;</span><br><span class="line">                    <span class="keyword">while</span> left &lt; right &amp;&amp; arrs[right] == arrs[right + <span class="number">1</span>] &#123; right -= <span class="number">1</span>; &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        res</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="42-接雨水"><a target="_blank" rel="noopener" href="https://leetcode.cn/problems/trapping-rain-water/">42. 接雨水</a></h2>
<p><img src="hot100-Day1%5Clc42.png" alt=""></p>
<blockquote>
<p>输入：height = [0,1,0,2,1,0,1,3,2,1,2,1]<br>
输出：6<br>
解释：上面是由数组 [0,1,0,2,1,0,1,3,2,1,2,1] 表示的高度图，在这种情况下，可以接 6 个单位的雨水（蓝色部分表示雨水）。</p>
</blockquote>
<h3 id="解法1-5">解法1</h3>
<p>看到这道题的时候想着一层一层算，不难发现在按层计算雨水的时候，这个面积不仅取决于两根柱子的区间，还取决于两根柱子中间最长的那一根。如下图所示，最高的一层取决于 $height[1]$，第二高的一层取决于 $height[5]$。我们可以得到一个规律，公式如下：<br>
$$<br>
height[l] &gt; height[i] \ \ \and \ \ height[r] &gt;height[i] \<br>
S_{h}=(min(height[l],height[r]) - height[i])*(r-l-1) \ \ \ \ \ <br>
$$<br>
<img src="hot100-Day1\lc42(2).png" alt="image.png" style="zoom:50%;" /></p>
<p>也就是说我们遍历 $[1, n-1]$ 区间的每根柱子，然后找到 $i$ 左右两侧的第一个最高柱子，然后套用上面的公式求得每一层的面积并累加即可。然而，我们还会发现第 $1$ 根柱子和第 $5$ 根柱子高度是一样的，如果再计算第 $5$ 根柱子的话，就会重复计算了一层高度。为此，在向左遍历的时候，遇到相同高度的主子的时候，需要放弃计算当前位置。</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">impl</span> Solution &#123;</span><br><span class="line">    <span class="keyword">pub</span> <span class="function"><span class="keyword">fn</span> <span class="title">trap</span></span>(height: <span class="built_in">Vec</span>&lt;<span class="built_in">i32</span>&gt;) -&gt; <span class="built_in">i32</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> (<span class="keyword">mut</span> lm, <span class="keyword">mut</span> rm) = (<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">let</span> <span class="keyword">mut</span> res = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">1</span>..height.len() - <span class="number">1</span> &#123;</span><br><span class="line">            lm = i;</span><br><span class="line">            rm = i;</span><br><span class="line">            <span class="comment">// 找左侧最大的第一个，从右往左找</span></span><br><span class="line">            <span class="keyword">for</span> l <span class="keyword">in</span> (<span class="number">0</span>..i).rev() &#123;</span><br><span class="line">                <span class="keyword">if</span> height[l] &gt;= height[i] &#123;</span><br><span class="line">                    lm = l;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">			<span class="comment">// 左侧出现相同的说明已经计算过，跳过即可</span></span><br><span class="line">            <span class="keyword">if</span> height[lm] == height[i] &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 找右侧最大的第一个，从左往右找</span></span><br><span class="line">            <span class="keyword">for</span> r <span class="keyword">in</span> i + <span class="number">1</span>..height.len() &#123;</span><br><span class="line">                <span class="keyword">if</span> height[r] &gt; height[i] &#123;</span><br><span class="line">                    rm = r;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 如果左右两侧不同时存在高于当前的柱子，则该柱子是最高的，无法接雨水</span></span><br><span class="line">            <span class="keyword">let</span> h = height[rm].min(height[lm]) - height[i];</span><br><span class="line">            <span class="keyword">if</span> h &gt; <span class="number">0</span> &#123;</span><br><span class="line">                res += h * (rm - lm - <span class="number">1</span>) <span class="keyword">as</span> <span class="built_in">i32</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        res</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>记录一下，2024/8/24第一次用这个方法写出来这道题了，距第一次看题解写出答案正好两个月。虽然这次也是看题解写的，但是大部分都是自己想出来的。</p>
<h3 id="解法2-6">解法2</h3>
<p>按层次计算的过程中，我们发现往后遍历的时候会重复计算相同高度的问题。而且我们似乎还可以按照每一列计算，这样就可以避免高度相同的问题。不过主要思路不再是找到左右两侧第一个最大的了，而是找左右两侧最大的，然后用如下公式计算：<br>
$$<br>
height[l]=height[0…i-1].max \ \ \and \ \ height[r]=height[i + 1, n - 1].max \<br>
S_{h}=min(height[l],height[r]) - height[i] \ \ \ \ \ <br>
$$</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">impl</span> Solution &#123;</span><br><span class="line">    <span class="keyword">pub</span> <span class="function"><span class="keyword">fn</span> <span class="title">trap</span></span>(height: <span class="built_in">Vec</span>&lt;<span class="built_in">i32</span>&gt;) -&gt; <span class="built_in">i32</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> (<span class="keyword">mut</span> lm, <span class="keyword">mut</span> rm) = (<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">let</span> <span class="keyword">mut</span> res = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">1</span>..height.len() - <span class="number">1</span> &#123;</span><br><span class="line">            lm = height[i];</span><br><span class="line">            rm = height[i];</span><br><span class="line">            <span class="comment">// 找左侧最大的</span></span><br><span class="line">            <span class="keyword">for</span> l <span class="keyword">in</span> (<span class="number">0</span>..i).rev() &#123;</span><br><span class="line">                lm = lm.max(height[l]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 找右侧最大的</span></span><br><span class="line">            <span class="keyword">for</span> r <span class="keyword">in</span> i + <span class="number">1</span>..height.len() &#123;</span><br><span class="line">                rm = rm.max(height[r]);</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">let</span> h = rm.min(lm) - height[i];</span><br><span class="line">            <span class="keyword">if</span> h &gt; <span class="number">0</span> &#123;</span><br><span class="line">                res += h;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        res</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="解法3-2">解法3</h3>
<p>解法2既然每次都要找到左右两侧最高的柱子，我们干脆直接用变量 $lmax, rmax$ 分别记录左右两侧最高的高度。细心观察，我们会发现不同的位置，左右两侧参考的高度是不一样的，但都取决于左右两侧中最低的那一侧。当 $height[i]&lt;=lmax&lt;=rmax$ 的时候，不管 $rmax$ 再怎么高，$S_{i}$ 也不会在变化。同理，当 $height[i]&lt;=rmax&lt;=lmax$ 的时候，不管 $lmax$ 再怎么高，$S_{i}$ 也不会在变化。其实，总结下来还是使用双指针的策略，判断 $lmax,rmax$ 的大小，然后决定继续向右计算还是向左计算。这个过程还是很不容易想出来的，很抽象，需要认真思考一下木桶原理。</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">class Solution &#123;</span><br><span class="line">public:</span><br><span class="line">    int trap(vector&lt;int&gt;&amp; height) &#123;</span><br><span class="line">        int res = <span class="number">0</span>;</span><br><span class="line">        int n = height.size();</span><br><span class="line">        int left = <span class="number">0</span>, right = n - <span class="number">1</span>;</span><br><span class="line">        int pre_max = <span class="number">0</span>, suf_max = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (left &lt; right) &#123;</span><br><span class="line">            pre_max = max(pre_max, height[left]);</span><br><span class="line">            suf_max = max(suf_max, height[right]);</span><br><span class="line">            res += pre_max &lt; suf_max ? pre_max - height[left++] : suf_max - height[right--];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/09/24/Hot100-Day1/" data-id="cm1gjmtk200005sve1jgadndq" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Rust-Warp处理HTTP请求" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2024/06/02/Rust-Warp%E5%A4%84%E7%90%86HTTP%E8%AF%B7%E6%B1%82/" class="article-date">
  <time datetime="2024-06-02T02:57:36.000Z" itemprop="datePublished">2024-06-02</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2024/06/02/Rust-Warp%E5%A4%84%E7%90%86HTTP%E8%AF%B7%E6%B1%82/">Rust Warp处理HTTP请求</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>在 Rust 的 <code>warp</code> 框架中，处理 HTTP 方法（GET、PUT、POST、DELETE）通常涉及定义路由和使用相应的 <code>warp</code> 函数来匹配请求路径和方法。以下是每种方法的详细示例，包括如何获取请求参数、请求体和响应。</p>
<h3 id="GET-请求示例">GET 请求示例</h3>
<p>GET 请求通常用于请求数据。</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> warp::Filter;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 简单的 GET 请求，返回 &quot;Hello, World!&quot;</span></span><br><span class="line"><span class="keyword">let</span> get_hello = warp::get()</span><br><span class="line">    .and(warp::path(<span class="string">&quot;hello&quot;</span>))</span><br><span class="line">    .map(|| <span class="string">&quot;Hello, World!&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// GET 请求，带查询参数</span></span><br><span class="line"><span class="keyword">let</span> get_query = warp::get()</span><br><span class="line">    .and(warp::path(<span class="string">&quot;query&quot;</span>))</span><br><span class="line">    .and(warp::query::&lt;Query&gt;()) <span class="comment">// 自定义结构体来解析查询参数</span></span><br><span class="line">    .map(|query: Query| &#123;</span><br><span class="line">        <span class="built_in">format!</span>(<span class="string">&quot;Hello, &#123;&#125;!&quot;</span>, query.name)</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义查询参数结构体</span></span><br><span class="line"><span class="meta">#[derive(serde::Deserialize)]</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Query</span></span> &#123;</span><br><span class="line">    name: <span class="built_in">String</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 组合路由</span></span><br><span class="line"><span class="keyword">let</span> get_routes = get_hello.or(get_query);</span><br></pre></td></tr></table></figure>
<h3 id="POST-请求示例">POST 请求示例</h3>
<p>POST 请求通常用于提交数据。</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> warp::Filter;</span><br><span class="line"><span class="keyword">use</span> serde::Deserialize;</span><br><span class="line"></span><br><span class="line"><span class="comment">// POST 请求，带 JSON 请求体</span></span><br><span class="line"><span class="keyword">let</span> post_json = warp::post()</span><br><span class="line">    .and(warp::path(<span class="string">&quot;json&quot;</span>))</span><br><span class="line">    .and(warp::body::json())</span><br><span class="line">    .map(|body: MyRequestBody| &#123;</span><br><span class="line">        <span class="built_in">format!</span>(<span class="string">&quot;Received: name = &#123;&#125;, age = &#123;&#125;&quot;</span>, body.name, body.age)</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义请求体结构体</span></span><br><span class="line"><span class="meta">#[derive(Deserialize)]</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">MyRequestBody</span></span> &#123;</span><br><span class="line">    name: <span class="built_in">String</span>,</span><br><span class="line">    age: <span class="built_in">u32</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// POST 请求，带表单请求体</span></span><br><span class="line"><span class="keyword">let</span> post_form = warp::post()</span><br><span class="line">    .and(warp::path(<span class="string">&quot;form&quot;</span>))</span><br><span class="line">    .and(warp::body::form())</span><br><span class="line">    .map(|name: <span class="built_in">String</span>, age: <span class="built_in">u32</span>| &#123; <span class="comment">// 从表单中解析数据</span></span><br><span class="line">        <span class="built_in">format!</span>(<span class="string">&quot;Received: name = &#123;&#125;, age = &#123;&#125;&quot;</span>, name, age)</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 组合路由</span></span><br><span class="line"><span class="keyword">let</span> post_routes = post_json.or(post_form);</span><br></pre></td></tr></table></figure>
<h3 id="PUT-请求示例">PUT 请求示例</h3>
<p>PUT 请求通常用于更新资源。</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> warp::Filter;</span><br><span class="line"><span class="keyword">use</span> serde::Deserialize;</span><br><span class="line"></span><br><span class="line"><span class="comment">// PUT 请求，带 JSON 请求体</span></span><br><span class="line"><span class="keyword">let</span> put_json = warp::put()</span><br><span class="line">    .and(warp::path(<span class="string">&quot;update&quot;</span>))</span><br><span class="line">    .and(warp::body::json())</span><br><span class="line">    .map(|body: MyRequestBody| &#123;</span><br><span class="line">        <span class="built_in">format!</span>(<span class="string">&quot;Updated: name = &#123;&#125;, age = &#123;&#125;&quot;</span>, body.name, body.age)</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// PUT 请求，带表单请求体</span></span><br><span class="line"><span class="keyword">let</span> put_form = warp::put()</span><br><span class="line">    .and(warp::path(<span class="string">&quot;update&quot;</span>))</span><br><span class="line">    .and(warp::body::form())</span><br><span class="line">    .map(|name: <span class="built_in">String</span>, age: <span class="built_in">u32</span>| &#123;</span><br><span class="line">        <span class="built_in">format!</span>(<span class="string">&quot;Updated: name = &#123;&#125;, age = &#123;&#125;&quot;</span>, name, age)</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 组合路由</span></span><br><span class="line"><span class="keyword">let</span> put_routes = put_json.or(put_form);</span><br></pre></td></tr></table></figure>
<h3 id="DELETE-请求示例">DELETE 请求示例</h3>
<p>DELETE 请求通常用于删除资源。</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> warp::Filter;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 简单的 DELETE 请求</span></span><br><span class="line"><span class="keyword">let</span> delete_simple = warp::delete()</span><br><span class="line">    .and(warp::path(<span class="string">&quot;delete&quot;</span>))</span><br><span class="line">    .map(|| <span class="string">&quot;Resource deleted&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// DELETE 请求，带路径参数</span></span><br><span class="line"><span class="keyword">let</span> delete_with_param = warp::delete()</span><br><span class="line">    .and(warp::path!(<span class="string">&quot;delete&quot;</span> / <span class="built_in">String</span>))</span><br><span class="line">    .map(|id: <span class="built_in">String</span>| &#123;</span><br><span class="line">        <span class="built_in">format!</span>(<span class="string">&quot;Resource with id &#123;&#125; deleted&quot;</span>, id)</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 组合路由</span></span><br><span class="line"><span class="keyword">let</span> delete_routes = delete_simple.or(delete_with_param);</span><br></pre></td></tr></table></figure>
<h3 id="组合所有路由">组合所有路由</h3>
<p>最后，你可以将所有路由组合在一起，并启动服务器。</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> warp::Filter;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 组合所有路由</span></span><br><span class="line"><span class="keyword">let</span> routes = get_routes.or(post_routes).or(put_routes).or(delete_routes);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 启动服务器</span></span><br><span class="line">warp::serve(routes)</span><br><span class="line">    .run(([<span class="number">127</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>], <span class="number">3030</span>)) <span class="comment">// 监听 localhost 的 3030 端口</span></span><br><span class="line">    .<span class="keyword">await</span>;</span><br></pre></td></tr></table></figure>
<p>请注意，示例中的 <code>MyRequestBody</code> 结构体需要你根据实际请求体来定义，并且要派生 <code>serde::Deserialize</code> 特性以便 <code>warp</code> 可以自动反序列化 JSON 请求体。</p>
<p>这些示例展示了如何在 <code>warp</code> 中处理不同的 HTTP 方法，并提供了基本的路由和请求处理逻辑。你可以根据需要扩展这些示例，添加认证、日志记录、错误处理等其他功能。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/06/02/Rust-Warp%E5%A4%84%E7%90%86HTTP%E8%AF%B7%E6%B1%82/" data-id="cm1gj9h070004m0ve22qrgois" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-HTTP请求内容" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2024/06/02/HTTP%E8%AF%B7%E6%B1%82%E5%86%85%E5%AE%B9/" class="article-date">
  <time datetime="2024-06-02T02:23:51.000Z" itemprop="datePublished">2024-06-02</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2024/06/02/HTTP%E8%AF%B7%E6%B1%82%E5%86%85%E5%AE%B9/">HTTP请求内容</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1>HTTP 请求</h1>
<p>最近学习 Rust 服务器开发的时候，自己并不清楚 HTTP 请求具体是什么。还好有 AIGC 能帮助我快速学习这部分知识，很难想象没有 AIGC 的时候我自己的学习方法是多么的低效。接下来进入正题：</p>
<p>HTTP 请求是客户端（比如一个网页浏览器）发送给服务器的请求信息，它用于获取服务器上的资源或执行某些操作。一个HTTP请求通常包含以下几个部分：</p>
<ol>
<li><strong>请求行</strong>：包含请求方法、请求的资源路径（URL）、HTTP 版本。</li>
<li><strong>请求头部</strong>（Headers）：包含请求的附加信息，如用户代理（User-Agent）、接受的媒体类型（Accept）、内容类型（Content-Type）等。</li>
<li><strong>请求体</strong>（可选）：对于某些请求方法（如 POST 或 PUT ），请求体包含发送给服务器的数据。</li>
</ol>
<h3 id="1-HTTP-GET">1. HTTP GET</h3>
<p>下面是一个简单的HTTP GET请求的例子：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/example.html</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>www.example.com</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.3</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>en-US,en;q=0.5</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate, br</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>keep-alive</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br></pre></td></tr></table></figure>
<p>这个 GET 请求的组成部分解释如下：</p>
<ul>
<li><strong>请求行</strong>：<code>GET /example.html HTTP/1.1</code> 表示这是一个GET请求，请求的资源是 <code>example.html</code>，使用的 HTTP 版本是 1.1。</li>
<li><strong>Host头部</strong>：<code>Host: www.example.com</code> 指定了请求的主机名，这对于虚拟主机非常重要，因为一台服务器可能托管多个域名。</li>
<li><strong>User-Agent头部</strong>：提供了发出请求的用户代理信息，这里显示了浏览器的类型和版本。</li>
<li><strong>Accept头部</strong>：告诉服务器客户端能够接受哪些类型的响应内容。</li>
<li><strong>Accept-Language头部</strong>：指定了客户端偏好的语言。</li>
<li><strong>Accept-Encoding头部</strong>：指定了客户端能够接受的压缩算法。</li>
<li><strong>Connection头部</strong>：通常设置为 <code>keep-alive</code> 表示希望保持连接以便发送多个请求，减少连接建立和关闭的开销。</li>
<li><strong>Upgrade-Insecure-Requests头部</strong>：请求服务器升级到更安全的连接（比如从HTTP到HTTPS）。</li>
</ul>
<p>请注意，这个例子中没有请求体，因为在 GET 请求中通常不包含请求体。如果是 POST 或 PUT 请求，请求体将包含要发送给服务器的数据。</p>
<h3 id="2-HTTP-POST">2. HTTP POST</h3>
<p>POST请求通常用于向服务器提交要被处理的数据。这可以是表单数据、JSON数据或其他类型的数据。</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/submit-form</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>www.example.com</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.3</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>27</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>en-US,en;q=0.5</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate, br</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>keep-alive</span><br><span class="line"></span><br><span class="line"><span class="ini"><span class="attr">username</span>=JohnDoe&amp;password=secret</span></span><br></pre></td></tr></table></figure>
<p>这个 POST 请求的组成部分解释如下：</p>
<ul>
<li><strong>请求行</strong>：<code>POST /submit-form HTTP/1.1</code> 表示这是一个 POST 请求，目标是 <code>/submit-form</code> 路径，使用的 HTTP 版本是 1.1。</li>
<li><strong>Host头部</strong>：指定了请求的主机名。</li>
<li><strong>User-Agent头部</strong>：提供了发出请求的用户代理信息。</li>
<li><strong>Content-Type头部</strong>：指定了请求体的媒体类型，这里是 <code>application/x-www-form-urlencoded</code>，表示请求体是URL编码的表单数据。</li>
<li><strong>Content-Length头部</strong>：指定了请求体的长度。</li>
<li><strong>请求体</strong>：包含了键值对数据，这里是一个用户名和密码。</li>
</ul>
<h3 id="3-HTTP-PUT">3. HTTP PUT</h3>
<p>PUT请求通常用于向服务器发送要被存储的资源。PUT请求可以包含请求体，其中包含要更新或创建的资源的内容。</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">PUT</span> <span class="string">/update-resource/123</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>www.example.com</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.3</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>53</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>application/json, text/javascript</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>en-US,en;q=0.5</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate, br</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>keep-alive</span><br><span class="line"></span><br><span class="line"><span class="json">&#123;</span></span><br><span class="line"><span class="json">    <span class="attr">&quot;id&quot;</span>: <span class="number">123</span>,</span></span><br><span class="line"><span class="json">    <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;New Resource Name&quot;</span>,</span></span><br><span class="line"><span class="json">    <span class="attr">&quot;description&quot;</span>: <span class="string">&quot;Updated description of the resource.&quot;</span></span></span><br><span class="line"><span class="json">&#125;</span></span><br></pre></td></tr></table></figure>
<p>这个 PUT 请求的组成部分解释如下：</p>
<ul>
<li><strong>请求行</strong>：<code>PUT /update-resource/123 HTTP/1.1</code> 表示这是一个PUT请求，目标是 <code>/update-resource/123</code> 路径，使用的HTTP版本是1.1。</li>
<li><strong>Host头部</strong>：指定了请求的主机名。</li>
<li><strong>User-Agent头部</strong>：提供了发出请求的用户代理信息。</li>
<li><strong>Content-Type头部</strong>：指定了请求体的媒体类型，这里是 <code>application/json</code>，表示请求体是JSON格式的数据。</li>
<li><strong>Content-Length头部</strong>：指定了请求体的长度。</li>
<li><strong>请求体</strong>：包含了 JSON 格式的数据，这里更新了一个资源的名称和描述。</li>
</ul>
<p>请注意，这些例子中的请求头和请求体内容可以根据实际情况进行调整。例如，Content-Type可以是其他类型，如<code>application/xml</code>或<code>multipart/form-data</code>，取决于客户端发送的数据类型。</p>
<h3 id="4-HTTP-DELET">4. HTTP DELET</h3>
<p>DELETE 请求通常用于从服务器上删除特定资源。以下是 DELETE 请求的一般格式：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> <span class="string">/path/to/resource</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>www.example.com</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"><span class="attribute">Authorization</span><span class="punctuation">: </span>Bearer token_value</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br><span class="line"><span class="ada">Optional Request <span class="keyword">Body</span></span></span><br></pre></td></tr></table></figure>
<p>这个 DELETE 请求的组成部分解释如下：</p>
<ul>
<li><strong>请求行</strong>：<code>DELETE /path/to/resource HTTP/1.1</code> 表示这是一个 DELETE 请求，目标是 <code>/path/to/resource</code> 路径，使用的HTTP版本是1.1。</li>
<li><strong>Host头部</strong>：指定了请求的主机名。</li>
<li><strong>Content-Type头部</strong>：指定了请求体的媒体类型，这里是 <code>application/json</code>，表示请求体是JSON格式的数据。</li>
<li><strong>Authorization</strong>（可选）：如果需要认证，这个头部包含了认证信息，例如 Bearer 令牌。</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/06/02/HTTP%E8%AF%B7%E6%B1%82%E5%86%85%E5%AE%B9/" data-id="cm1gj9h050002m0vebe737a85" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Rust单链表" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2024/05/11/Rust%E5%8D%95%E9%93%BE%E8%A1%A8/" class="article-date">
  <time datetime="2024-05-11T14:40:42.000Z" itemprop="datePublished">2024-05-11</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2024/05/11/Rust%E5%8D%95%E9%93%BE%E8%A1%A8/">Rust单链表</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1>Rust 单链表（Stack）</h1>
<p>​		用C/C++实现链表的时候，我们都需要先定义一个如下的结构体，这样我们就可以利用指针来实现链表的基本操作了，具体过程这里就忽略了（好久没写过C++了，已经不会写了…）。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">List</span> &#123;</span></span><br><span class="line">	<span class="keyword">int</span> val;</span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">List</span>* <span class="title">next</span>;</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="思路1">思路1</h3>
<p>​		这段代码中定义了一个枚举 <code>List</code>，它有两个变体：<code>Empty</code> 表示空列表，<code>Elem</code> 包含一个整数元素和另一个 <code>List</code>。</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">pub</span> <span class="class"><span class="keyword">enum</span> <span class="title">List</span></span> &#123;</span><br><span class="line">    Empty,</span><br><span class="line">    Elem(<span class="built_in">i32</span>, List),</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$ cargo run</span><br><span class="line">error[E0072]: recursive <span class="class"><span class="keyword">type</span> `<span class="title">List</span></span>` has infinite size</span><br><span class="line"> --&gt; src/first.rs:<span class="number">1</span>:<span class="number">1</span></span><br><span class="line">  |</span><br><span class="line"><span class="number">1</span> | <span class="keyword">pub</span> <span class="class"><span class="keyword">enum</span> <span class="title">List</span></span> &#123;</span><br><span class="line">  | ^^^^^^^^^^^^^ recursive <span class="class"><span class="keyword">type</span> <span class="title">has</span></span> infinite size</span><br><span class="line"><span class="number">2</span> |     Empty,</span><br><span class="line"><span class="number">3</span> |     Elem(<span class="built_in">i32</span>, List),</span><br><span class="line">  |               ---- recursive without indirection</span><br><span class="line">help: insert some indirection (e.g., a `<span class="built_in">Box</span>`, `Rc`, or `&amp;`) to make `List` representable</span><br><span class="line">  |</span><br><span class="line"><span class="number">3</span> |     Elem(<span class="built_in">i32</span>, <span class="built_in">Box</span>&lt;List&gt;),</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>​		这竟然是错的，编译器提示递归定义，我们需要使用间接的方式（指针）使链表可展示，这是因为我们不知道当前节点需要链接的链表是什么样子的，它的大小是未知的，编译器无法确定，这在 Rust 中是不允许的，因为 Rust 需要在编译时确定类型的大小。为了解决这个问题，它提示我们使用 <code>Box</code> ，<code>Rc</code>或<code>&amp;</code>来包装 <code>List</code> 类型，以便使它变为一个已知大小的指针。</p>
<h3 id="思路2">思路2</h3>
<p>​		我让gpt帮我生成了一个<code>&amp;</code>包装的<code>List</code> 类型（生命周期这里我了解的还不是很深入，等搞懂了我再来修改这篇文章），感觉这样的操作跟C++指针很像。</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">pub</span> <span class="class"><span class="keyword">enum</span> <span class="title">List</span></span>&lt;<span class="symbol">&#x27;a</span>&gt; &#123;</span><br><span class="line">    Empty,</span><br><span class="line">    Elem(<span class="built_in">i32</span>, &amp;<span class="symbol">&#x27;a</span> List&lt;<span class="symbol">&#x27;a</span>&gt;),</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#[cfg(test)]</span></span><br><span class="line"><span class="keyword">pub</span> <span class="keyword">mod</span> first &#123;</span><br><span class="line">    <span class="keyword">use</span> super::List;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">#[test]</span></span><br><span class="line">    <span class="function"><span class="keyword">fn</span> <span class="title">basics</span></span>() &#123;</span><br><span class="line">        <span class="keyword">let</span> empty_list = List::Empty;</span><br><span class="line">        <span class="keyword">let</span> list_with_one_element = List::Elem(<span class="number">1</span>, &amp;empty_list);</span><br><span class="line">        <span class="keyword">let</span> list_with_two_elements = List::Elem(<span class="number">2</span>, &amp;list_with_one_element);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>​		可是当我们想要销毁某个节点的时候，这个时候就会遇到很多问题了。在 Rust 中，基于 <code>&amp;</code> 实现手动释放特定节点的内存是相当困难的，因为 Rust 的所有权模型不允许直接释放引用的内存。但是，你可以使用 <code>unsafe</code> 代码块来绕过 Rust 的安全检查，手动释放节点的内存。但是这样做非常不推荐，因为可能导致内存安全问题，包括内存泄漏、野指针等。这里我们了解一下可以这样实现即可，以后也不会这样构造一个链表。</p>
<h3 id="思路3">思路3</h3>
<p>​		这次我们使用<code>Box</code>包装的<code>List</code> 类型来实现单链表（栈 Stack）。</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">pub</span> <span class="class"><span class="keyword">enum</span> <span class="title">List</span></span> &#123;</span><br><span class="line">    Empty,</span><br><span class="line">    Elem(<span class="built_in">i32</span>, <span class="built_in">Box</span>&lt;List&gt;),</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>​		当生成新的节点的时候，它会在栈内存中给头节点分配内存空间，其他节点都被分配到堆内存中。</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[] = Stack</span><br><span class="line">() = Heap</span><br><span class="line"></span><br><span class="line">[Elem A, ptr] -&gt; (Elem B, ptr) -&gt; (Empty, *junk*)</span><br></pre></td></tr></table></figure>
<p>​		链表的最后一个元素看起来并不像是一个<code>Node</code>，可是它还是被分配到了堆内存。此外，明明是同样的结构，为什么只把头节点分配到栈内存中呢？这显然不是一种合理的解法。其实，我们更希望所有节点在堆上，但是又觉得最后一个节点不应该在堆上。那再来考虑另一种方式：</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[ptr] -&gt; (Elem A, ptr) -&gt; (Elem B, ptr) -&gt; (Elem C, *null*)</span><br><span class="line"></span><br><span class="line">从Elem C对应的节点将链表拆分为两个链表，它的形式应该如下：</span><br><span class="line"></span><br><span class="line">[ptr] -&gt; (Elem A, ptr) -&gt; (Elem B, *null*)</span><br><span class="line">[ptr] -&gt; (Elem C, *null*)</span><br></pre></td></tr></table></figure>
<p>​		此外，从编程的角度而言，我们希望让实现细节只保留在内部，而不是对外公开，因此以下代码相对会更加适合（这里我自己将链表的数据类型实现了泛型）：</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// [ptr] -&gt; (elem1, ptr2) -&gt; (elem2, ptr3) -&gt; (elem3, ptr4) -&gt; (elem4, null)</span></span><br><span class="line"><span class="comment">// []stack ()heap</span></span><br><span class="line"><span class="keyword">use</span> std::mem;</span><br><span class="line"><span class="keyword">pub</span> <span class="class"><span class="keyword">struct</span> <span class="title">List</span></span>&lt;T&gt; &#123;</span><br><span class="line">    head: Link&lt;T&gt;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Link</span></span>&lt;T&gt; &#123;</span><br><span class="line">    Empty,</span><br><span class="line">    NonEmpty(<span class="built_in">Box</span>&lt;Node&lt;T&gt;&gt;),</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span></span>&lt;T&gt; &#123;</span><br><span class="line">    elem: T,</span><br><span class="line">    next: Link&lt;T&gt;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">impl</span>&lt;T&gt; List&lt;T&gt; &#123;</span><br><span class="line">    <span class="keyword">pub</span> <span class="function"><span class="keyword">fn</span> <span class="title">new</span></span>() -&gt; <span class="keyword">Self</span> &#123;</span><br><span class="line">        List &#123; head: Link::Empty &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">pub</span> <span class="function"><span class="keyword">fn</span> <span class="title">push</span></span>(&amp;<span class="keyword">mut</span> <span class="keyword">self</span>, var: T) &#123;</span><br><span class="line">        <span class="keyword">let</span> new_node = <span class="built_in">Box</span>::new(Node &#123;</span><br><span class="line">            elem: var,</span><br><span class="line">            <span class="comment">// 虽然我们在方法签名中传递了 &amp;mut self，</span></span><br><span class="line">            <span class="comment">// 但是在 mem::replace() 中使用了 &amp;mut self.head </span></span><br><span class="line">            <span class="comment">// 是因为我们实际上是在修改 self.head 的内容，而不是 self 本身。</span></span><br><span class="line">            next: mem::replace(&amp;<span class="keyword">mut</span> <span class="keyword">self</span>.head, Link::Empty),</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">self</span>.head = Link::NonEmpty(new_node);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">pub</span> <span class="function"><span class="keyword">fn</span> <span class="title">pop</span></span>(&amp;<span class="keyword">mut</span> <span class="keyword">self</span>) -&gt; <span class="built_in">Option</span>&lt;T&gt; &#123;</span><br><span class="line">        <span class="keyword">match</span> mem::replace(&amp;<span class="keyword">mut</span> <span class="keyword">self</span>.head, Link::Empty) &#123;</span><br><span class="line">            Link::Empty =&gt; <span class="literal">None</span>,</span><br><span class="line">            Link::NonEmpty(node) =&gt; &#123;</span><br><span class="line">                <span class="keyword">self</span>.head = node.next;</span><br><span class="line">                <span class="literal">Some</span>(node.elem)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">impl</span>&lt;T&gt; <span class="built_in">Drop</span> <span class="keyword">for</span> List&lt;T&gt; &#123;</span><br><span class="line">    <span class="function"><span class="keyword">fn</span> <span class="title">drop</span></span>(&amp;<span class="keyword">mut</span> <span class="keyword">self</span>) &#123;</span><br><span class="line">        <span class="comment">// 当前节点是NonEmpty类型时，将它替换为Empty类型。</span></span><br><span class="line">        <span class="keyword">while</span> <span class="keyword">let</span> Link::NonEmpty(<span class="keyword">mut</span> node ) = mem::replace(&amp;<span class="keyword">mut</span> <span class="keyword">self</span>.head, Link::Empty) &#123;</span><br><span class="line">            <span class="keyword">self</span>.head = mem::replace(&amp;<span class="keyword">mut</span> node.next, Link::Empty);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;   </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#[cfg(test)]</span></span><br><span class="line"><span class="keyword">pub</span> <span class="keyword">mod</span> first &#123;</span><br><span class="line">    <span class="keyword">use</span> super::List;</span><br><span class="line"></span><br><span class="line">    <span class="meta">#[test]</span></span><br><span class="line">    <span class="function"><span class="keyword">fn</span> <span class="title">basics</span></span>() &#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="keyword">mut</span> list = List::new();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Check empty list behaves right</span></span><br><span class="line">        <span class="built_in">assert_eq!</span>(list.pop(), <span class="literal">None</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Populate list</span></span><br><span class="line">        list.push(<span class="number">1</span>);</span><br><span class="line">        list.push(<span class="number">2</span>);</span><br><span class="line">        list.push(<span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Check normal removal</span></span><br><span class="line">        <span class="built_in">assert_eq!</span>(list.pop(), <span class="literal">Some</span>(<span class="number">3</span>));</span><br><span class="line">        <span class="built_in">assert_eq!</span>(list.pop(), <span class="literal">Some</span>(<span class="number">2</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Push some more just to make sure nothing&#x27;s corrupted</span></span><br><span class="line">        list.push(<span class="number">4</span>);</span><br><span class="line">        list.push(<span class="number">5</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Check normal removal</span></span><br><span class="line">        <span class="built_in">assert_eq!</span>(list.pop(), <span class="literal">Some</span>(<span class="number">5</span>));</span><br><span class="line">        <span class="built_in">assert_eq!</span>(list.pop(), <span class="literal">Some</span>(<span class="number">4</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Check exhaustion</span></span><br><span class="line">        <span class="built_in">assert_eq!</span>(list.pop(), <span class="literal">Some</span>(<span class="number">1</span>));</span><br><span class="line">        <span class="built_in">assert_eq!</span>(list.pop(), <span class="literal">None</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/05/11/Rust%E5%8D%95%E9%93%BE%E8%A1%A8/" data-id="cm1gj9h080005m0ve9w3e8995" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-以太坊测试网络Rinkeby使用教程" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/07/10/%E4%BB%A5%E5%A4%AA%E5%9D%8A%E6%B5%8B%E8%AF%95%E7%BD%91%E7%BB%9CRinkeby%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/" class="article-date">
  <time datetime="2022-07-10T08:23:22.000Z" itemprop="datePublished">2022-07-10</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2022/07/10/%E4%BB%A5%E5%A4%AA%E5%9D%8A%E6%B5%8B%E8%AF%95%E7%BD%91%E7%BB%9CRinkeby%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/">以太坊测试网络Rinkeby使用教程</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>出于学习和测试的目的，以太坊官方推出了一些测试网络，使用了与主网络不同的创世区块，测试网中的代币是没有价值的。以太坊公开的测试网络共有4个，目前仍在运行的有4个，分别为Goerli、Ropsten、Kovan、Rinkeby。</p>
<img src="/2022/07/10/%E4%BB%A5%E5%A4%AA%E5%9D%8A%E6%B5%8B%E8%AF%95%E7%BD%91%E7%BB%9CRinkeby%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220710154934533.png" class="">
<h3 id="一、Rinkeby">一、Rinkeby</h3>
<p>​	Rinkeby 是开发人员目前常用的测试网络，使用PoA共识机制，访问地址: <a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https%3A%2F%2Fwww.rinkeby.io%2F">https://www.rinkeby.io/</a><br>
​	本文从以下几方面介绍Rinkeby 的基本使用方法：</p>
<ul>
<li>创建 Rinkeby 账户</li>
<li>获取 Rinkeby 的以太币</li>
<li>智能合约部署</li>
<li>智能合约交互</li>
</ul>
<h3 id="二、创建-Rinkeby-账户">二、创建 Rinkeby 账户</h3>
<p>​	首先我们需要一个钱包来管理账户，目前可选的有MetaMask、Coinbase Wallet、WalletConnect等，我比较推荐使用主流的MetaMask钱包。本篇文章的所有操作均通过MetaMask进行操作。</p>
<p>​	1、安装MetaMask</p>
<p>​	MetaMask属于浏览器插件应用，官网：<a target="_blank" rel="noopener" href="https://metamask.io/">The crypto wallet for Defi, Web3 Dapps and NFTs | MetaMask</a>，进入后下载安装即可。</p>
<p>​	2、注册</p>
<p>​	接下来就是简单的注册过程，此处需要保存好自己的助记词。按照我的理解，助记词是为了让你在忘记MetaMask登录密码时能够找回自己的钱包。MetaMask钱包能够注册多个账户。</p>
<p>​	3、切换至Rinkeby测试网络环境</p>
<p>​	<img src="/2022/07/10/%E4%BB%A5%E5%A4%AA%E5%9D%8A%E6%B5%8B%E8%AF%95%E7%BD%91%E7%BB%9CRinkeby%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220710155752391.png" class=""></p>
<h3 id="三、获取Rinkeby-的以太币">三、获取Rinkeby 的以太币</h3>
<p>​	刚注册的账户是没有以太币的，想获取Rinkeby测试网络中的以太币，需要我们通过官方给出的方法去申请，这个申请Rinkeby以太币的功能被称为水龙头(Faucet)。网站地址：<a target="_blank" rel="noopener" href="https://www.rinkeby.io/#faucet">https://www.rinkeby.io/#faucet</a> （有时候水龙头服务节点会问题，无法申请到测试币，我们可以自行百度其他申请方式）</p>
<p>​	为了确保不会出现有人滥用水龙头，无限申请Rinkeby以太币。水龙头需要借助第三方账号来确定申请者的身份和配额。目前提供的获取方法是在Twitter、FaceBook任意一个社交网络上发布一条带有钱包地址的消息，并将消息的网址粘贴到上面截图的输入框中选个获取就可以。我们以FaceBook账户为例（额，我的Twitter不知道什么原因被冻结了，无法发布帖子）。</p>
<img src="/2022/07/10/%E4%BB%A5%E5%A4%AA%E5%9D%8A%E6%B5%8B%E8%AF%95%E7%BD%91%E7%BB%9CRinkeby%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220710160112111.png" class="">
<p>​	自行注册一个twitter或facebook账号即可，然后发一条帖子。</p>
<img src="/2022/07/10/%E4%BB%A5%E5%A4%AA%E5%9D%8A%E6%B5%8B%E8%AF%95%E7%BD%91%E7%BB%9CRinkeby%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220710160258929.png" class="">
<p>发布的内容就是钱包地址，获取方式如下图所示。</p>
<img src="/2022/07/10/%E4%BB%A5%E5%A4%AA%E5%9D%8A%E6%B5%8B%E8%AF%95%E7%BD%91%E7%BB%9CRinkeby%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220710160356133.png" class="">
<p>​	发送成功后，进入这条Tweet内容，然后copy以下当前推文的地址。</p>
<img src="/2022/07/10/%E4%BB%A5%E5%A4%AA%E5%9D%8A%E6%B5%8B%E8%AF%95%E7%BD%91%E7%BB%9CRinkeby%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220619213140683.png" class="">
<p>​	将刚才复制的地址粘贴到Rinkeby Authenticated Faucet的URL输入框中，随意选择一个测试币的有效时间即可。</p>
<img src="/2022/07/10/%E4%BB%A5%E5%A4%AA%E5%9D%8A%E6%B5%8B%E8%AF%95%E7%BD%91%E7%BB%9CRinkeby%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220619213306397.png" class="">
<p>​	稍等片刻，MetaMask上就会显示我们当前账户的余额。</p>
<h3 id="四、智能合约部署">四、智能合约部署</h3>
<p>​	如果使用的是MetaMask的话，你必须要有智能合约的源码，不然没有办法部署成功。如果向通过ABI和Bytecode部署的话可以使用Myetherwallet钱包。</p>
<p>​	1、编译智能合约</p>
<p>​	<img src="/2022/07/10/%E4%BB%A5%E5%A4%AA%E5%9D%8A%E6%B5%8B%E8%AF%95%E7%BD%91%E7%BB%9CRinkeby%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220710162030797.png" class=""></p>
<p>​	2、部署智能合约</p>
<p>​	<img src="/2022/07/10/%E4%BB%A5%E5%A4%AA%E5%9D%8A%E6%B5%8B%E8%AF%95%E7%BD%91%E7%BB%9CRinkeby%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220710162051195.png" class=""></p>
<h3 id="六、智能合约交互">六、智能合约交互</h3>
<p>​	当智能合约部署成功后，我们会在上图5号红框那里看到智能合约中开放的所有API，如下图所示：</p>
<img src="/2022/07/10/%E4%BB%A5%E5%A4%AA%E5%9D%8A%E6%B5%8B%E8%AF%95%E7%BD%91%E7%BB%9CRinkeby%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220710162152235.png" class="">
<p>​	我们根据函数功能，将参数填入输入框后点击左侧函数名称即可实现智能合约交互。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/07/10/%E4%BB%A5%E5%A4%AA%E5%9D%8A%E6%B5%8B%E8%AF%95%E7%BD%91%E7%BB%9CRinkeby%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/" data-id="cm1gj9h080006m0ve5rmb9k42" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-如何在Linux上部署IPFS" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/07/08/%E5%A6%82%E4%BD%95%E5%9C%A8Linux%E4%B8%8A%E9%83%A8%E7%BD%B2IPFS/" class="article-date">
  <time datetime="2022-07-08T14:52:25.000Z" itemprop="datePublished">2022-07-08</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2022/07/08/%E5%A6%82%E4%BD%95%E5%9C%A8Linux%E4%B8%8A%E9%83%A8%E7%BD%B2IPFS/">如何在Linux云服务器上部署IPFS</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="一、准备必须的环境">一、准备必须的环境</h3>
<h4 id="配置GoLang环境">配置GoLang环境</h4>
<p>下载GoLang二进制文件</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /home</span><br><span class="line">// 建议自己去GitHub上找一下最新版的链接</span><br><span class="line">wget https://go.dev/dl/go1.18.3.linux-amd64.tar.gz</span><br><span class="line">tar -zxvf go1.18.3.linux-amd64.tar.gz -C /usr/<span class="built_in">local</span></span><br></pre></td></tr></table></figure>
<p>配置GoLang环境</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/profile</span><br><span class="line"></span><br><span class="line"><span class="comment">#文件末尾追加（类似于配置java环境）</span></span><br><span class="line"><span class="comment"># golang env</span></span><br><span class="line"><span class="built_in">export</span> GOROOT=/usr/<span class="built_in">local</span>/go</span><br><span class="line"><span class="built_in">export</span> GOPATH=/data/gopath</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$GOROOT</span>/bin:<span class="variable">$GOPATH</span>/bin</span><br><span class="line"></span><br><span class="line"><span class="built_in">source</span> /etc/profile</span><br></pre></td></tr></table></figure>
<h3 id="二、IPFS部署">二、IPFS部署</h3>
<p>下载go-ipfs二进制文件，解压后运行install.sh脚本。（因为服务器在国外，所以可能wget失败go-ipfs二进制文件，建议直接去GitHub下载后上传到服务器，GoLang二进制文件同理）</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">wget https://dist.ipfs.io/go-ipfs/v0.13.0/go-ipfs_v0.13.0_linux-amd64.tar.gz</span><br><span class="line">tar -xvzf go-ipfs_v0.13.0_linux-amd64.tar.gz</span><br><span class="line"><span class="built_in">cd</span> go-ipfs</span><br><span class="line">sudo bash install.sh</span><br></pre></td></tr></table></figure>
<p>测试是否安装成功：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ipfs --version</span><br><span class="line"><span class="comment"># 成功的话会显示ipfs版本号</span></span><br><span class="line">&gt; ipfs version 0.13.0</span><br></pre></td></tr></table></figure>
<p>如果需要指定ipfs的存储位置，则修改下面bash</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> IPFS_PATH=<span class="string">&quot;/root/.ipfs/&quot;</span>   <span class="comment">#这里的路径是样例，可以修改为自己的路径 </span></span><br></pre></td></tr></table></figure>
<p>IPFS初始化</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ipfs init</span><br><span class="line">ipfs cat /ipfs/QmQPeNsJPyVWPFDVHb77w8G42Fvo15z4bG2X8D2GhfbSXc/readme  <span class="comment">#根据init而来</span></span><br><span class="line">ipfs id</span><br></pre></td></tr></table></figure>
<img src="/2022/07/08/%E5%A6%82%E4%BD%95%E5%9C%A8Linux%E4%B8%8A%E9%83%A8%E7%BD%B2IPFS/ipfs_init.png" class="">
<img src="/2022/07/08/%E5%A6%82%E4%BD%95%E5%9C%A8Linux%E4%B8%8A%E9%83%A8%E7%BD%B2IPFS/ipfs_id.png" class="">
<p>ipfs文件夹存放在/root/下面（通过ipfs init可得），路径可根据当前ubuntu 用户而定，此处我用的root权限。文件如下：</p>
<img src="/2022/07/08/%E5%A6%82%E4%BD%95%E5%9C%A8Linux%E4%B8%8A%E9%83%A8%E7%BD%B2IPFS/ipfs_files.png" class="">
<ul>
<li>blocks:文件块内容</li>
<li>conifg:配置文件</li>
<li>datastore_spec:存储本地数据</li>
<li>keystore:存储公私钥对</li>
<li>version:版本信息</li>
</ul>
<h3 id="三、修改配置文件config">三、修改配置文件config</h3>
<p>把配置文件中的Address下的API 和 Gatway 的IP地址改为自己的本地地址，如果是部署在虚拟机中想通过本机访问的话全改为0.0.0.0。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi config</span><br></pre></td></tr></table></figure>
<img src="/2022/07/08/%E5%A6%82%E4%BD%95%E5%9C%A8Linux%E4%B8%8A%E9%83%A8%E7%BD%B2IPFS/ipfs_viconfig.png" class="">
<h3 id="四、开启节点">四、开启节点</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ipfs daemon</span><br></pre></td></tr></table></figure>
<img src="/2022/07/08/%E5%A6%82%E4%BD%95%E5%9C%A8Linux%E4%B8%8A%E9%83%A8%E7%BD%B2IPFS/ipfs_daemon.png" class="">
<p>在浏览器中输入图中的WebUI:<a target="_blank" rel="noopener" href="http://xn--IP-fr5c86lx7z:5001/webui,%E5%B0%B1%E4%BC%9A%E5%BC%B9%E5%87%BA%EF%BC%9A">http://服务器IP:5001/webui,就会弹出：</a></p>
<img src="/2022/07/08/%E5%A6%82%E4%BD%95%E5%9C%A8Linux%E4%B8%8A%E9%83%A8%E7%BD%B2IPFS/ipfs_success.png" class="">
<p>以上就是完整的部署过程~</p>
<p>如果你是部署在云服务上的话，这时你会出下下面错误：</p>
<img src="/2022/07/08/%E5%A6%82%E4%BD%95%E5%9C%A8Linux%E4%B8%8A%E9%83%A8%E7%BD%B2IPFS/ipfs_webui1.png" class="">
<p>这里出现问题是因为默认配置没有解决路由跨域问题，只需要运行下面的两条bash再刷新就成功了！</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/07/08/%E5%A6%82%E4%BD%95%E5%9C%A8Linux%E4%B8%8A%E9%83%A8%E7%BD%B2IPFS/" data-id="cm1gj9h0b0009m0ve1dt47m9i" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-如何使用goblintownNFT智能合约发布属于自己的NFT" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/07/08/%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8goblintownNFT%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6%E5%8F%91%E5%B8%83%E5%B1%9E%E4%BA%8E%E8%87%AA%E5%B7%B1%E7%9A%84NFT/" class="article-date">
  <time datetime="2022-07-08T14:35:29.166Z" itemprop="datePublished">2022-07-08</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2022/07/08/%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8goblintownNFT%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6%E5%8F%91%E5%B8%83%E5%B1%9E%E4%BA%8E%E8%87%AA%E5%B7%B1%E7%9A%84NFT/">如何使用goblintownNFT智能合约发布属于自己的NFT</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="一、安装并注册MateMask钱包账户">一、安装并注册MateMask钱包账户</h3>
<p>1、安装MetaMask</p>
<p>MetaMask属于浏览器插件应用，官网：<a target="_blank" rel="noopener" href="https://metamask.io/">The crypto wallet for Defi, Web3 Dapps and NFTs | MetaMask</a>，进入后下载安装即可。</p>
<p>2、注册</p>
<p>接下来就是简单的注册过程，此处需要保存好自己的助记词。按照我的理解，助记词是为了让你在忘记MetaMask登录密码时能够找回自己的钱包。MetaMask钱包能够注册多个账户。</p>
<h3 id="二、切换至Rinkeby测试网络">二、切换至Rinkeby测试网络</h3>
<p>此处参考我的另一篇博客<a target="_blank" rel="noopener" href="http://localhost:4000/2022/07/10/%E4%BB%A5%E5%A4%AA%E5%9D%8A%E6%B5%8B%E8%AF%95%E7%BD%91%E7%BB%9CRinkeby%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/">《Rinkeby以太坊测试网络部署》</a></p>
<h3 id="三、goblintownNFT合约的部署">三、goblintownNFT合约的部署</h3>
<p>1、进入<a target="_blank" rel="noopener" href="https://etherscan.io/address/0xbce3781ae7ca1a5e050bd9c4c77369867ebc307e#code">goblintown</a>将该项目的智能合约copy到在线solidity编辑网站<a target="_blank" rel="noopener" href="https://remix.ethereum.org/">Remix</a></p>
<img src="/2022/07/08/%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8goblintownNFT%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6%E5%8F%91%E5%B8%83%E5%B1%9E%E4%BA%8E%E8%87%AA%E5%B7%B1%E7%9A%84NFT/1.png" class="">
<p>2、编译并部署到以太坊测试网络Rinkeby中</p>
<img src="/2022/07/08/%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8goblintownNFT%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6%E5%8F%91%E5%B8%83%E5%B1%9E%E4%BA%8E%E8%87%AA%E5%B7%B1%E7%9A%84NFT/2.png" class="">
<p>最左侧红框中没有出现红色就说明智能合约语法不存在错误。</p>
<img src="/2022/07/08/%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8goblintownNFT%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6%E5%8F%91%E5%B8%83%E5%B1%9E%E4%BA%8E%E8%87%AA%E5%B7%B1%E7%9A%84NFT/3.png" class="">
<p>不出意外的话，到这里合约就已经部署完成了。5号红框那里有合约在以太坊上的地址，我们可以到Etherscan中查看这个地址，包括后续的一些合约操作，交易记录等都会在上面显示。同时，我们可以看到合约中的函数，如下图所示：</p>
<img src="/2022/07/08/%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8goblintownNFT%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6%E5%8F%91%E5%B8%83%E5%B1%9E%E4%BA%8E%E8%87%AA%E5%B7%B1%E7%9A%84NFT/4.png" class="">
<h3 id="四、将我们的NFT-Meta-json文件放置到IPFS上">四、将我们的NFT Meta_json文件放置到IPFS上</h3>
<p>IPFS我使用的是 <a target="_blank" rel="noopener" href="https://app.pinata.cloud/">Pinata</a> ，它好像有一个免费的1G存储容量。不过也可以自己搭建IPFS服务器，具体可参考我的另一篇博客<a target="_blank" rel="noopener" href="https://chwzx.github.io/2022/07/08/%E5%A6%82%E4%BD%95%E5%9C%A8Linux%E4%B8%8A%E9%83%A8%E7%BD%B2IPFS/">《如何在Linux上部署IPFS》</a>。NFT的JSON格式如下：</p>
<img src="/2022/07/08/%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8goblintownNFT%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6%E5%8F%91%E5%B8%83%E5%B1%9E%E4%BA%8E%E8%87%AA%E5%B7%B1%E7%9A%84NFT/5.png" class="">
<p>我们自己NFT的JSON文件放在一个文件夹里上传到IPFS服务器上，注意JSON文件的<strong>文件名</strong>和<strong>后缀</strong>。例如：</p>
<p><img src="D:%5Cwzx%5CDocuments%5Cblog%5Csource_posts%5C%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8goblintownNFT%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6%E5%8F%91%E5%B8%83%E5%B1%9E%E4%BA%8E%E8%87%AA%E5%B7%B1%E7%9A%84NFT%5C6.png" alt=""></p>
<p>上传完成后会显示下面界面，我们最终需要的就是该文件的<strong>CID</strong>。</p>
<img src="/2022/07/08/%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8goblintownNFT%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6%E5%8F%91%E5%B8%83%E5%B1%9E%E4%BA%8E%E8%87%AA%E5%B7%B1%E7%9A%84NFT/7.png" class="">
<h3 id="五、mint-NFT">五、mint NFT</h3>
<img src="/2022/07/08/%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8goblintownNFT%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6%E5%8F%91%E5%B8%83%E5%B1%9E%E4%BA%8E%E8%87%AA%E5%B7%B1%E7%9A%84NFT/10.png" class="">
<p>按照顺序依次执行以上步骤，我们就可以得到我们自己的NFT啦~</p>
<img src="/2022/07/08/%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8goblintownNFT%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6%E5%8F%91%E5%B8%83%E5%B1%9E%E4%BA%8E%E8%87%AA%E5%B7%B1%E7%9A%84NFT/9.png" class="">
<p>首先，我在这里解释一下tokenid，我的理解是tokenid = num(NFT) - 1，例如你已经有10个NFT，那么tokenid = 9。在刚开始部署智能合约的时候 tokenid = 0，每次mint NFT的时候，会执行智能合约中的totalSupply函数来获得当前num(NFT)。</p>
<p>opensea通过获取ipfs://CID/<strong>string</strong>文件的方式来展示NFT（因为存在放ipfs上的资源可以通过URL直接在浏览器上访问到，具体的URL格式如：<a target="_blank" rel="noopener" href="https://ipfs.io/ipfs/QmfPoHvSMMJ8V5XtWGSbWUqAMy6vkNyH7P8aw3uc2134gY/0">https://ipfs.io/ipfs/QmfPoHvSMMJ8V5XtWGSbWUqAMy6vkNyH7P8aw3uc2134gY/0</a>  ，服务器在国外，ipfs.io这个域名可能会访问不到，更换一个可用的域名 <a target="_blank" rel="noopener" href="https://ipfs.github.io/public-gateway-checker/">IPFS公共网关</a>  即可），在该智能合约中<strong>tokenid = 地址中的string</strong>，这样就是为什么我们需要把JSON文件的后缀去除掉。上面图片中名称是3的NFT是空图，是因为该图片在IPFS服务器中的文件格式为3.json，这时候代码opensea是识别不出来的，具体原因如下图源码可知。</p>
<img src="/2022/07/08/%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8goblintownNFT%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6%E5%8F%91%E5%B8%83%E5%B1%9E%E4%BA%8E%E8%87%AA%E5%B7%B1%E7%9A%84NFT/8.png" class="">

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/07/08/%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8goblintownNFT%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6%E5%8F%91%E5%B8%83%E5%B1%9E%E4%BA%8E%E8%87%AA%E5%B7%B1%E7%9A%84NFT/" data-id="cm1gj9h0b0008m0vef6u63mxk" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-区块链溯源系统环境部署" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/03/06/%E5%8C%BA%E5%9D%97%E9%93%BE%E6%BA%AF%E6%BA%90%E7%B3%BB%E7%BB%9F%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2/" class="article-date">
  <time datetime="2022-03-05T16:54:40.819Z" itemprop="datePublished">2022-03-06</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2022/03/06/%E5%8C%BA%E5%9D%97%E9%93%BE%E6%BA%AF%E6%BA%90%E7%B3%BB%E7%BB%9F%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2/">区块链溯源系统环境部署</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>以下教程是在win10上完成的。</p>
<h1>软件安装</h1>
<p>nodejs安装：<a target="_blank" rel="noopener" href="https://nodejs.org/zh-cn/download/">https://nodejs.org/zh-cn/download/</a>   这是用来运行前端的</p>
<p>win键+r键 ，输入cmd,看一下npm版本，有版本就代表成功了。</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">C:\<span class="title">Users</span>\2407288830&gt;<span class="title">npm</span> -<span class="title">version</span></span></span><br><span class="line"><span class="function">6.13.4  </span></span><br></pre></td></tr></table></figure>
<p>idea安装和破解：<a target="_blank" rel="noopener" href="https://www.mubucm.com/doc/rTDUIGvfnk">https://www.mubucm.com/doc/rTDUIGvfnk</a>   用来运行后端</p>
<p>java jdk要求：建议1.8版本      一定要是64位的，不然使用链区块sdk的时候会报错</p>
<p>finalshell安装：<a target="_blank" rel="noopener" href="http://www.hostbuf.com/t/988.html">http://www.hostbuf.com/t/988.html</a>   相当于xshell，用来连接服务器的。</p>
<h1>Hyperledger Fabric1.4.0 环境配置</h1>
<p>部署最简单的Hyperleger fabric，首先需要买个服务器:<a target="_blank" rel="noopener" href="https://www.aliyun.com/minisite/goods?userCode=svaj1q3t&amp;share_source=copy_link">https://www.aliyun.com/minisite/goods?userCode=svaj1q3t&amp;share_source=copy_link</a></p>
<p>有钱买配置好一点，2核4G，没钱买1核2G，当然带宽是越大越好，5M最好，1M也可以用，就是有点慢，Centos和Ubuntu系统都行，我这个教程用的是Centos系统。如果你使用虚拟机也是完全ok的，但是操作可能会有一点点小的事故，比如连不上网，可能需要百度一下自己解决一下。</p>
<h2 id="开放服务器的端口">开放服务器的端口</h2>
<img src="/2022/03/06/%E5%8C%BA%E5%9D%97%E9%93%BE%E6%BA%AF%E6%BA%90%E7%B3%BB%E7%BB%9F%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2/image1.png" class="">
<img src="/2022/03/06/%E5%8C%BA%E5%9D%97%E9%93%BE%E6%BA%AF%E6%BA%90%E7%B3%BB%E7%BB%9F%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2/image-20211213152631550.png" class="">
<img src="/2022/03/06/%E5%8C%BA%E5%9D%97%E9%93%BE%E6%BA%AF%E6%BA%90%E7%B3%BB%E7%BB%9F%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2/image-20211213152650088.png" class="">
<img src="/2022/03/06/%E5%8C%BA%E5%9D%97%E9%93%BE%E6%BA%AF%E6%BA%90%E7%B3%BB%E7%BB%9F%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2/image-20211213152706298.png" class="">
<h2 id="使用finalShell连接服务器">使用finalShell连接服务器</h2>
<img src="/2022/03/06/%E5%8C%BA%E5%9D%97%E9%93%BE%E6%BA%AF%E6%BA%90%E7%B3%BB%E7%BB%9F%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2/image-20211214141123682.png" class="">
<img src="/2022/03/06/%E5%8C%BA%E5%9D%97%E9%93%BE%E6%BA%AF%E6%BA%90%E7%B3%BB%E7%BB%9F%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2/image-20211214141744104.png" class="">
<img src="/2022/03/06/%E5%8C%BA%E5%9D%97%E9%93%BE%E6%BA%AF%E6%BA%90%E7%B3%BB%E7%BB%9F%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2/image-20211214141920066.png" class="">
<img src="/2022/03/06/%E5%8C%BA%E5%9D%97%E9%93%BE%E6%BA%AF%E6%BA%90%E7%B3%BB%E7%BB%9F%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2/image-20211214142651435.png" class="">
<h2 id="Fabric-v1-4-0安装部署-全程复制粘贴就ok">Fabric v1.4.0安装部署  全程复制粘贴就ok</h2>
<h3 id="一、前期准备">一、前期准备</h3>
<table>
<thead>
<tr>
<th>编号</th>
<th>工具</th>
<th>版本号</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td><a target="_blank" rel="noopener" href="https://curl.haxx.se/download.html">cURL</a></td>
<td>最新版（7.63.0）</td>
</tr>
<tr>
<td>2</td>
<td><a target="_blank" rel="noopener" href="https://www.docker.com/get-started">Docker</a></td>
<td>17.06.2-ce及其以上版本</td>
</tr>
<tr>
<td>3</td>
<td><a target="_blank" rel="noopener" href="https://docs.docker.com/compose/overview/">Docker Compose</a></td>
<td>1.14.0及其以上版本</td>
</tr>
<tr>
<td>4</td>
<td><a target="_blank" rel="noopener" href="https://golang.org/dl/">Go</a></td>
<td>1.11.x</td>
</tr>
</tbody>
</table>
<ol>
<li>
<p><strong>cURL最新版安装</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 下载最新版的cURL并将其解压到指定目录（此处以/opt目录为例）</span></span><br><span class="line"><span class="built_in">cd</span> /</span><br><span class="line">mkdir resource</span><br><span class="line"><span class="built_in">cd</span> /resource</span><br><span class="line">wget https://curl.haxx.se/download/curl-7.63.0.tar.gz</span><br><span class="line">sudo tar xzvf curl-7.63.0.tar.gz -C /opt</span><br><span class="line"></span><br><span class="line"><span class="comment"># 编译并安装cURL</span></span><br><span class="line"><span class="built_in">cd</span> /opt/curl-7.63.0</span><br><span class="line">./configure</span><br><span class="line">make</span><br><span class="line">sudo make install</span><br></pre></td></tr></table></figure>
<p>通过运行<code>curl --version</code>查看是否安装成功，若结果如下图所示，则表示安装成功。</p>
<p><strong>若出现下图所示错误，则需进行如下操作,没出现错误则不需要以下操作。</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在/etc/ld.so.conf加入/usr/local/lib这一行内容</span></span><br><span class="line">sudo <span class="built_in">echo</span> <span class="string">&quot;/usr/local/lib&quot;</span> &gt;&gt; /etc/ld.so.conf</span><br><span class="line"></span><br><span class="line"><span class="comment"># 执行下列命令使加入的内容生效</span></span><br><span class="line">sudo /sbin/ldconfig -v</span><br></pre></td></tr></table></figure>
</li>
<li>
<p><strong>Docker和Docker Compose安装</strong></p>
<ul>
<li>
<p>Docker(参考<a target="_blank" rel="noopener" href="https://docs.docker.com/engine/install/centos/">Get Docker CE for Ubuntu</a>)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install -y yum-utils</span><br><span class="line"></span><br><span class="line">sudo yum-config-manager \</span><br><span class="line">    --add-repo \</span><br><span class="line">    https://download.docker.com/linux/centos/docker-ce.repo</span><br><span class="line">   </span><br><span class="line">sudo yum install docker-ce docker-ce-cli containerd.io</span><br><span class="line"><span class="comment">#启动docker</span></span><br><span class="line">sudo systemctl start docker</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>Docker Compose</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 下载Docker Compose二进制文件,这一步可能出现下载不了的情况，会一直等待建立连接，ctrl+C终止掉，多试几次就好了</span></span><br><span class="line"></span><br><span class="line">sudo curl -L <span class="string">&quot;https://github.com/docker/compose/releases/download/1.23.2/docker-compose-<span class="subst">$(uname -s)</span>-<span class="subst">$(uname -m)</span>&quot;</span> -o /usr/<span class="built_in">local</span>/bin/docker-compose</span><br><span class="line"></span><br><span class="line">sudo chmod +x /usr/<span class="built_in">local</span>/bin/docker-compose</span><br><span class="line"><span class="comment">#可以查看是否安装成功</span></span><br><span class="line">docker-compose -version</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li>
<p><strong>Go安装</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 下载go1.11.linux-amd64.tar.gz并将其解压到指定目录（此处为/usr/local）</span></span><br><span class="line"> <span class="built_in">cd</span> /resource/</span><br><span class="line">wget https://studygolang.com/dl/golang/go1.11.linux-amd64.tar.gz</span><br><span class="line">tar xzvf go1.11.linux-amd64.tar.gz -C /usr/<span class="built_in">local</span></span><br><span class="line">touch goenvset.sh</span><br><span class="line">vim goenvset.sh</span><br><span class="line"><span class="comment">#按i插入以下内容，ESC键退出，shift键+:键输入wq 回车退出</span></span><br><span class="line">goenvset.sh文件内容如下所示：</span><br><span class="line"></span><br><span class="line">cat &gt;&gt; /etc/profile &lt;&lt; <span class="string">EOF</span></span><br><span class="line"><span class="string">export GOROOT=/usr/local/go</span></span><br><span class="line"><span class="string">export GOARCH=amd64</span></span><br><span class="line"><span class="string">export GOOS=linux</span></span><br><span class="line"><span class="string">export GOPATH=/home/ubuntu/gopath</span></span><br><span class="line"><span class="string">export GOBIN=$GOPATH/bin</span></span><br><span class="line"><span class="string">export PATH=$GOPATH/bin:$GOROOT/bin:$PATH</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 执行已有的goenvset.sh向/etc/profile中写入相应的环境变量</span></span><br><span class="line">sudo chmod 705 goenvset.sh      <span class="comment"># 更改goenvset.sh的权限使其可执行</span></span><br><span class="line">sudo ./goenvset.sh				<span class="comment"># 执行goenvset.sh脚本</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使环境变量生效</span></span><br><span class="line"><span class="built_in">source</span> /etc/profile</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="二、Fabric安装">二、Fabric安装</h3>
<ol>
<li>
<p>将fabric-samples下载到<code>$GOPATH/src/github.com/hyperledger</code>目录中</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p <span class="variable">$GOPATH</span>/src/github.com/hyperledger</span><br><span class="line"><span class="built_in">cd</span> <span class="variable">$GOPATH</span>/src/github.com/hyperledger</span><br><span class="line"><span class="comment"># 克隆fabric-samples项目并切换到v1.4tag</span></span><br><span class="line">yum -y install git</span><br><span class="line"><span class="comment">#这一步容易卡在一直处于建立连接中，ctrl+c断掉，重新再来</span></span><br><span class="line">git <span class="built_in">clone</span> https://github.com/hyperledger/fabric-samples.git</span><br><span class="line"><span class="built_in">cd</span> fabric-samples</span><br><span class="line">git checkout -b sample v1.4.0</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>安装Fabric Binaries和Fabric相关的Docker镜像</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> <span class="variable">$GOPATH</span>/src/github.com/hyperledger/fabric-samples/scripts</span><br><span class="line">vim bootstrap.sh </span><br><span class="line"></span><br><span class="line"><span class="comment">#用#注释掉binaryDownload()函数</span></span><br></pre></td></tr></table></figure>
<img src="/2022/03/06/%E5%8C%BA%E5%9D%97%E9%93%BE%E6%BA%AF%E6%BA%90%E7%B3%BB%E7%BB%9F%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2/image-20211214151145232.png" class="">
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">安装Fabric、Fabric-ca以及第三方Docker镜像（./bootstrap.sh &lt;fabric&gt; &lt;fabric-ca&gt; &lt;thirdparty&gt;）</span><br><span class="line">./bootstrap.sh 1.4.0 1.4.0 0.4.14</span><br></pre></td></tr></table></figure>
<p>值得注意的是，如果由于网络问题，此处通过<code>bootstrap.sh</code>脚本安装可能会出错，此时可进行手动安装。安装步骤如下：</p>
<ul>
<li>
<p>将指定版本的Hyperledger Fabric特定于平台的二进制文件和配置文件安装到fabric-samples的bin和config目录中</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /resource/</span><br><span class="line">wget https://github.com/hyperledger/fabric/releases/download/v1.4.0/hyperledger-fabric-linux-amd64-1.4.0.tar.gz</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">wget https://github.com/hyperledger/fabric-ca/releases/download/v1.4.0/hyperledger-fabric-ca-linux-amd64-1.4.0.tar.gz</span><br><span class="line"></span><br><span class="line">tar xzvf hyperledger-fabric-linux-amd64-1.4.0.tar.gz -C <span class="variable">$GOPATH</span>/src/github.com/hyperledger/fabric-samples/</span><br><span class="line">tar xzvf hyperledger-fabric-ca-linux-amd64-1.4.0.tar.gz -C <span class="variable">$GOPATH</span>/src/github.com/hyperledger/fabric-samples/</span><br><span class="line"></span><br><span class="line"><span class="comment">#向/etc/profile中写入环境变量</span></span><br><span class="line">sudo <span class="built_in">echo</span> <span class="string">&#x27;export PATH=$GOPATH/src/github.com/hyperledger/fabric-samples/bin:$PATH&#x27;</span> &gt;&gt; /etc/profile</span><br><span class="line"></span><br><span class="line"><span class="comment">#使环境变量生效</span></span><br><span class="line"><span class="built_in">source</span> /etc/profile</span><br></pre></td></tr></table></figure>
<h3 id="bootstrap-sh脚本成功下载文件，以下不需要操作-不需要操作">bootstrap.sh脚本成功下载文件，以下不需要操作,不需要操作</h3>
</li>
<li>
<p>下载相关Docker镜像</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 下载Fabric相关镜像（fabric-peer、fabric-orderer、fabric-ccenv、fabric-tools），此处以fabric-peer镜像为例，其他镜像同理</span></span><br><span class="line">docker pull hyperledger/fabric-peer:1.4.0</span><br><span class="line">docker tag hyperledger/fabric-peer:1.4.0 hyperledger/fabric-peer:latest</span><br><span class="line"></span><br><span class="line"><span class="comment"># 下载Fabric第三方镜像（fabric-couchdb、fabric-kafka、fabric-zookeeper），此处以fabric-couchdb为例，其他镜像同理</span></span><br><span class="line">docker pull hyperledger/fabric-couchdb:0.4.14</span><br><span class="line">docker tag hyperledger/fabric-couchdb:0.4.14 hyperledger/fabric-couchdb:latest</span><br><span class="line"></span><br><span class="line"><span class="comment"># 下载Fabric CA镜像</span></span><br><span class="line">docker pull hyperledger/fabric-ca:1.4.0</span><br><span class="line">docker tag hyperledger/fabric-ca:1.4.0 hyperledger/fabric-ca:latest</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>（可选）镜像的备份与恢复</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将上述Docker镜像存储到fabric-images文件中</span></span><br><span class="line">docker save $(docker images | grep fabric | grep latest | awk <span class="string">&#x27;&#123;print $1&#125;&#x27;</span>) -o fabric-images</span><br><span class="line"><span class="comment"># 若需要多机部署，则通过下列命令将其分发到其他机器</span></span><br><span class="line">scp fabric-images ubuntu@192.168.70.21:~</span><br><span class="line"><span class="comment"># 在192.168.70.21上加载上述镜像</span></span><br><span class="line">docker load -o fabric-images</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="通过运行Build-your-first-network样例来进行测试">通过运行<code>Build your first network</code>样例来进行测试</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> <span class="variable">$GOPATH</span>/src/github.com/hyperledger/fabric-samples/first-network</span><br><span class="line"><span class="comment"># 编译通过Golang开发的chaincode并启动相关的容器</span></span><br><span class="line">启动（过程比较长，可能需要几分钟）</span><br><span class="line">./byfn.sh up   </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#停止first-network网络中所有的容器，删除crypto材料和4个artifacts（genesis.block、mychannel.block、Org1MSPanchor.tx、Org2MSPanchor.tx）以及chaincode镜像</span></span><br><span class="line">./byfn.sh down   <span class="comment">#请不要随便使用该命令</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<img src="/2022/03/06/%E5%8C%BA%E5%9D%97%E9%93%BE%E6%BA%AF%E6%BA%90%E7%B3%BB%E7%BB%9F%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2/image-20211215145958700.png" class=""> 
<p>到这里就算运行成功。</p>
<h1>项目运行</h1>
<p>sdkdemo是fabric sdk,运行sdkdemo就可以了。</p>
<img src="/2022/03/06/%E5%8C%BA%E5%9D%97%E9%93%BE%E6%BA%AF%E6%BA%90%E7%B3%BB%E7%BB%9F%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2/image-20211215153244642.png" class=""> 
<h2 id="运行后端项目">运行后端项目</h2>
<img src="/2022/03/06/%E5%8C%BA%E5%9D%97%E9%93%BE%E6%BA%AF%E6%BA%90%E7%B3%BB%E7%BB%9F%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2/image-20211215153505822.png" class="">
<h2 id="运行前端项目">运行前端项目</h2>
<p>在目录oldlot中输入cmd回车</p>
<img src="/2022/03/06/%E5%8C%BA%E5%9D%97%E9%93%BE%E6%BA%AF%E6%BA%90%E7%B3%BB%E7%BB%9F%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2/image-20211215153559581.png" class="">
<p>输入npm run dev 回车</p>
<img src="/2022/03/06/%E5%8C%BA%E5%9D%97%E9%93%BE%E6%BA%AF%E6%BA%90%E7%B3%BB%E7%BB%9F%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2/image-20211215153705078.png" class=""> 
<p>注意：如果发现没有node_modules目录，需要先执行一下npm install</p>
<h2 id="运行区块链sdk">运行区块链sdk</h2>
<h3 id="准备工作">准备工作</h3>
<h6 id="域名映射">域名映射</h6>
<p>编辑<code>C:\Windows\System32\drivers\etc\host</code><br>
在最后一行添加下面内容,192.168.xx.xx是你自己服务器(虚拟机)的地址</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">192.168.xx.xx	peer0.org1.example.com peer1.org1.example.com peer0.org2.example.com peer1.org2.example.com orderer.example.com</span><br></pre></td></tr></table></figure>
<h6 id="启动网络">启动网络</h6>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">更改世界状态数据库是couchdb启动</span></span><br><span class="line"><span class="meta">#</span><span class="bash">访问方式：ip:5984/_utils</span></span><br><span class="line">cd /home/ubuntu/gopath/src/github.com/hyperledger/fabric-samples/first-network</span><br><span class="line">./byfn.sh up -s couchdb</span><br><span class="line"><span class="meta">#</span><span class="bash">启动2个org，4个peer，1个cli，4个couchdb,1个kafka</span></span><br><span class="line">docker-compose -f docker-compose-cli.yaml -f docker-compose-couch.yaml -f docker-compose-kafka.yaml start</span><br></pre></td></tr></table></figure>
<h6 id="生成tx文件">生成tx文件</h6>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /home/ubuntu/gopath/src/github.com/hyperledger/fabric-samples/first-network</span><br><span class="line">../bin/configtxgen -profile TwoOrgsChannel -outputCreateChannelTx channel-artifacts/test.tx -channelID test</span><br></pre></td></tr></table></figure>
<img src="/2022/03/06/%E5%8C%BA%E5%9D%97%E9%93%BE%E6%BA%AF%E6%BA%90%E7%B3%BB%E7%BB%9F%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2/image-20211215171522972.png" class="">
<blockquote>
<p>将<code>/opt/gopath/src/github.com/hyperledger/fabric/scripts/fabric-samples/first-network</code>目录下的<code>crypto-config</code>文件拷贝到工程的<code>resources</code>目录下<br>
注意：其中在<code>1.4.6</code>版本<code>peerOrganization-org1(2)-users-Admin-msp-admincerts</code>目录下的文件没有，但是可以拷贝同个目录下的<code>signcerts</code>的文件</p>
</blockquote>
<p>将生成的<code>test.tx</code>文件拷贝到<code>idea</code>工程的<code>resources</code>目录下</p>
<img src="/2022/03/06/%E5%8C%BA%E5%9D%97%E9%93%BE%E6%BA%AF%E6%BA%90%E7%B3%BB%E7%BB%9F%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2/image-20211215171631083.png" class="">
<img src="/2022/03/06/%E5%8C%BA%E5%9D%97%E9%93%BE%E6%BA%AF%E6%BA%90%E7%B3%BB%E7%BB%9F%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2/image-20211215171838437.png" class="">
<img src="/2022/03/06/%E5%8C%BA%E5%9D%97%E9%93%BE%E6%BA%AF%E6%BA%90%E7%B3%BB%E7%BB%9F%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2/image-20211215171950996.png" class="">
<img src="/2022/03/06/%E5%8C%BA%E5%9D%97%E9%93%BE%E6%BA%AF%E6%BA%90%E7%B3%BB%E7%BB%9F%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2/image-20211215171914106.png" class="">
<p>IDEA乱码配置，之前的项目这样配置的，你可以按照这样配置下，不然可能乱码</p>
<img src="/2022/03/06/%E5%8C%BA%E5%9D%97%E9%93%BE%E6%BA%AF%E6%BA%90%E7%B3%BB%E7%BB%9F%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2/image-20211215162603128.png" class="">　
<p>idea打开sdkdemo</p>
<p><strong>注意:java 的jdk一定要是64位</strong></p>
<p>路径是双斜杠\\</p>
<img src="/2022/03/06/%E5%8C%BA%E5%9D%97%E9%93%BE%E6%BA%AF%E6%BA%90%E7%B3%BB%E7%BB%9F%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2/image-20211215162915220.png" class="">
<img src="/2022/03/06/%E5%8C%BA%E5%9D%97%E9%93%BE%E6%BA%AF%E6%BA%90%E7%B3%BB%E7%BB%9F%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2/image-20211215163124434.png" class=""> 
<img src="/2022/03/06/%E5%8C%BA%E5%9D%97%E9%93%BE%E6%BA%AF%E6%BA%90%E7%B3%BB%E7%BB%9F%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2/image-20211215164437760.png" class="">
<p>运行sdkdemo项目</p>
<p>在浏览器中调用sdkdemo</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#在浏览器中依次访问下面的网址，不要重复执行</span><br><span class="line">#创建通道</span><br><span class="line"><span class="function">http://<span class="title">localhost</span>:8081/<span class="title">sdk</span>/<span class="title">createChannel</span></span></span><br><span class="line"><span class="function"><span class="title">http</span>://<span class="title">localhost</span>:8081/<span class="title">sdk</span>/<span class="title">createChannel2</span></span></span><br><span class="line"><span class="function">#安装智能合约</span></span><br><span class="line"><span class="function"><span class="title">http</span>://<span class="title">localhost</span>:8081/<span class="title">sdk</span>/<span class="title">chainCodeInstall</span></span></span><br><span class="line"><span class="function"><span class="title">http</span>://<span class="title">localhost</span>:8081/<span class="title">sdk</span>/<span class="title">chainCodeInstall2</span></span></span><br><span class="line"><span class="function">#实例化智能合约,比较慢</span></span><br><span class="line"><span class="function"><span class="title">http</span>://<span class="title">localhost</span>:8081/<span class="title">sdk</span>/<span class="title">init</span></span></span><br></pre></td></tr></table></figure>
<p>三种用户，可以去表里面找对应的账户和密码</p>
<img src="/2022/03/06/%E5%8C%BA%E5%9D%97%E9%93%BE%E6%BA%AF%E6%BA%90%E7%B3%BB%E7%BB%9F%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2/image-20211215175716453.png" class=""> 

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/03/06/%E5%8C%BA%E5%9D%97%E9%93%BE%E6%BA%AF%E6%BA%90%E7%B3%BB%E7%BB%9F%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2/" data-id="cm1gj9h0a0007m0vee5vfdltx" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-ACM_数论" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/03/06/ACM_%E6%95%B0%E8%AE%BA/" class="article-date">
  <time datetime="2022-03-05T16:54:40.815Z" itemprop="datePublished">2022-03-06</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2022/03/06/ACM_%E6%95%B0%E8%AE%BA/">ACM 数论部分</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>ACM/ICPC中的数学</p>
<h2 id="一些数论基本定理">一些数论基本定理</h2>
<p>( a + b ) mod c = ((a mod c) + (b mod c)) mod c<br>
( a * b ) mod c = ((a mod c) * (b mod c)) mod c</p>
<p>消去律：若 gcd(c,p) = 1,则(gcd表示同余数)<br>
ac ≡ bc mod p =&gt; a ≡ b mod p</p>
<h3 id="快速幂">快速幂</h3>
<p>算法一</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Pow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123; <span class="comment">//快速求a^b ，复杂度 log(b) </span></span><br><span class="line">    <span class="keyword">if</span>(b == <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>; </span><br><span class="line">    <span class="keyword">if</span>(b &amp; <span class="number">1</span>) &#123; <span class="comment">//b是奇数</span></span><br><span class="line">        <span class="keyword">return</span> a * <span class="built_in">Pow</span>(a,b<span class="number">-1</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">int</span> t = <span class="built_in">Pow</span>(a,b/<span class="number">2</span>);</span><br><span class="line">        <span class="keyword">return</span> t * t;</span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>算法二</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Pow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123; <span class="comment">//快速求a^b ，复杂度 log(b) </span></span><br><span class="line">    <span class="keyword">int</span> result = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> base = a;</span><br><span class="line">    <span class="keyword">while</span>(b) &#123;</span><br><span class="line">        <span class="keyword">if</span>( b &amp; <span class="number">1</span>) </span><br><span class="line">            result *= base;</span><br><span class="line">        base *= base;</span><br><span class="line">        b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="快速幂取模">快速幂取模</h3>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">PowMod</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b,<span class="keyword">int</span> c)</span></span></span><br><span class="line"><span class="function"></span>&#123;<span class="comment">//快速求 a^b % c ，要避免计算中间结果溢出</span></span><br><span class="line">    <span class="keyword">int</span> result = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> base = a%c;</span><br><span class="line">    <span class="keyword">while</span>(b) &#123;</span><br><span class="line">        <span class="keyword">if</span>( b &amp; <span class="number">1</span>) </span><br><span class="line">            result = (result * base)%c;</span><br><span class="line">        base = (base * base) % c;</span><br><span class="line">        b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="等比数列二分求和取模">等比数列二分求和取模</h3>
<p>Sn= a+a2+…+an<br>
要求 Sn mod p<br>
如果用公式算，可能溢出，因此用二分法求</p>
<ol>
<li>若 n 是偶数<br>
Sn= a+…+an/2 + an/2+1 + an/2+2 +…+ an/2+n/2<br>
=(a+…+an/2) + an/2(a+…+an/2)<br>
=Sn/2+ an/2Sn/2<br>
=(1+an/2)Sn/2</li>
<li>若n是奇数<br>
Sn= a+…+a(n-1)/2 + a(n-1)/2+1 +…+<br>
   a(n-1)/2+(n-1)/2 + a(n-1)/2+(n-1)/2 + 1<br>
=S(n-1)/2 + a(n-1)/2(a+…+a(n-1)/2)+an<br>
=(1+a(n-1)/2)S(n-1)/2+an</li>
</ol>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">PowSumMod</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> n,<span class="keyword">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;<span class="comment">// return (a+ a^2 + ... + a^n) Mod p;</span></span><br><span class="line">    <span class="keyword">if</span>( n == <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> a%p;</span><br><span class="line">    <span class="keyword">if</span>( n %<span class="number">2</span> == <span class="number">0</span>) </span><br><span class="line">        <span class="keyword">return</span> (<span class="number">1</span>+<span class="built_in">PowMod</span>(a,n/<span class="number">2</span>,p))*<span class="built_in">PowSumMod</span>(a,n/<span class="number">2</span>,p) % p;</span><br><span class="line">    <span class="keyword">else</span> </span><br><span class="line">        <span class="built_in"><span class="keyword">return</span></span> ((<span class="number">1</span>+<span class="built_in">PowMod</span>(a,(n<span class="number">-1</span>)/<span class="number">2</span>,p)) * <span class="built_in">PowSumMod</span>(a,(n<span class="number">-1</span>)/<span class="number">2</span>,p) + <span class="built_in">PowMod</span>(a,n,p)) % p;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/03/06/ACM_%E6%95%B0%E8%AE%BA/" data-id="cm1gj9h020001m0veabjahq8f" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Hyperldeger-Fabric环境搭建" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/01/11/Hyperldeger-Fabric%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/" class="article-date">
  <time datetime="2022-01-11T15:09:06.000Z" itemprop="datePublished">2022-01-11</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2022/01/11/Hyperldeger-Fabric%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/">Hyperldeger Fabric环境搭建</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Hyperledger-Fabric环境搭建">Hyperledger Fabric环境搭建</h2>
<h3 id="Linux环境">Linux环境</h3>
<p>Vmware或者云服务器，推荐CentOS7.0版本及以上，Ubuntu也可以。</p>
<p>因为hyperledger fabric源码在github上，自己搭建Linux环境大概率会在后面出现git项目失败。为了节省时间，我毕业设计的服务器搭建在了腾讯云服务器上。在云服务器上一下步骤一遍通过！2022年1月11日尝试用VMWare虚拟机中的CentOS7.6搭建一下环境，中间出现了多次git失败的情况，最终耗费数小时还是成功部署环境。</p>
<h3 id="更换yum源">更换yum源</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装vim</span></span><br><span class="line">yum install vim</span><br><span class="line">yum install wget -y</span><br><span class="line"><span class="built_in">cd</span> /etc/yum.repos.d/</span><br><span class="line">wget http://mirrors.aliyun.com/repo/Centos-7.repoC</span><br><span class="line">mv CentOS-Base.repo CentOS-Base.repo.bak</span><br><span class="line">mv Centos-7.repo CentOS-Base.repo</span><br><span class="line">yum clean all</span><br><span class="line">yum makecache</span><br><span class="line">yum update</span><br></pre></td></tr></table></figure>
<h3 id="docker">docker</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 卸载旧版本的docker</span></span><br><span class="line">sudo yum remove docker \</span><br><span class="line">                  docker-client \</span><br><span class="line">                  docker-client-latest \</span><br><span class="line">                  docker-common \</span><br><span class="line">                  docker-latest \</span><br><span class="line">                  docker-latest-logrotate \</span><br><span class="line">                  docker-logrotate \</span><br><span class="line">                  docker-engine</span><br><span class="line"></span><br><span class="line">sudo yum install -y yum-utils</span><br><span class="line"></span><br><span class="line">sudo yum-config-manager \</span><br><span class="line">    --add-repo \</span><br><span class="line">    https://download.docker.com/linux/centos/docker-ce.repo</span><br><span class="line">    </span><br><span class="line">sudo yum install docker-ce docker-ce-cli containerd.io</span><br><span class="line"></span><br><span class="line"><span class="comment"># 启动docker</span></span><br><span class="line">sudo systemctl start docker</span><br></pre></td></tr></table></figure>
<p>​	配置docker镜像站，这里我用的是daocloud的镜像站。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -sSL https://get.daocloud.io/daotools/set_mirror.sh | sh -s http://f1361db2.m.daocloud.io</span><br></pre></td></tr></table></figure>
<h3 id="docker-compose">docker-compose</h3>
<p>这里我用vmware虚拟机下载不下来docker-compose，目前不知道解决办法。云服务器倒是能够直接访问github下载到docker-compose。（我猜测主要原因是网络问题，毕竟需要从github上拉代码）</p>
<p>这里的代码是从docker-compose官网安装教程上复制来的。不过可能使用的时候出现网络错误而不能成功运行。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo curl -L <span class="string">&quot;https://github.com/docker/compose/releases/download/1.29.2/docker-compose-<span class="subst">$(uname -s)</span>-<span class="subst">$(uname -m)</span>&quot;</span> -o /usr/<span class="built_in">local</span>/bin/docker-compose</span><br></pre></td></tr></table></figure>
<p>这里我用的下面命令才把dock-compose二进制代码从github拉下来，二者区别主要是docker-compose版本号</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sudo curl -L <span class="string">&quot;https://github.com/docker/compose/releases/download/1.23.2/docker-compose-<span class="subst">$(uname -s)</span>-<span class="subst">$(uname -m)</span>&quot;</span> -o /usr/<span class="built_in">local</span>/bin/docker-compose</span><br><span class="line"></span><br><span class="line">sudo chmod +x /usr/<span class="built_in">local</span>/bin/docker-compose</span><br><span class="line"></span><br><span class="line">//查看是否安装成功，docker版本号</span><br><span class="line">docker-compose --version</span><br><span class="line">docker-compose version 1.23.2, build 1110ad01</span><br></pre></td></tr></table></figure>
<h3 id="Golang">Golang</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mkdir /resource</span><br><span class="line"><span class="built_in">cd</span> /resource/</span><br><span class="line">wget https://studygolang.com/dl/golang/go1.11.linux-amd64.tar.gz</span><br><span class="line">tar xzvf go1.11.linux-amd64.tar.gz -C /usr/<span class="built_in">local</span></span><br></pre></td></tr></table></figure>
<p>配置环境变量</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 这个目录用来存放go的一些源码（我理解为库函数）</span></span><br><span class="line">mkdir /opt/gopath</span><br><span class="line">vim /etc/profile</span><br><span class="line"><span class="comment"># 将下面代码粘贴进去（这里的GOPATH自己可以选一个自己想放的位置）</span></span><br><span class="line"><span class="built_in">export</span> GOROOT=/usr/<span class="built_in">local</span>/go</span><br><span class="line"><span class="built_in">export</span> GOPATH=/opt/gopath</span><br><span class="line"><span class="built_in">export</span> GOROOT=/usr/<span class="built_in">local</span>/go</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$GOROOT</span>/bin</span><br><span class="line"><span class="comment"># 使环境变量生效</span></span><br><span class="line"><span class="built_in">source</span> /etc/profile</span><br><span class="line"><span class="comment"># 查看是否配置成功</span></span><br><span class="line">go env</span><br></pre></td></tr></table></figure>
<h3 id="Fabric安装">Fabric安装</h3>
<ol>
<li>
<p>将fabric-samples下载到<code>$GOPATH/src/github.com/hyperledger</code>目录中</p>
<p>网上很多教程都是fabirc 1.4.0版本的，但是现在从github上git下来的项目中是不存在first-network这个，需要将版本切换到1.4.0。</p>
</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p <span class="variable">$GOPATH</span>/src/github.com/hyperledger</span><br><span class="line"><span class="built_in">cd</span> <span class="variable">$GOPATH</span>/src/github.com/hyperledger</span><br><span class="line"><span class="comment"># 首先安装git</span></span><br><span class="line">yum -y install git</span><br><span class="line"><span class="comment"># 克隆fabric-samples项目并切换到v1.4tag</span></span><br><span class="line"><span class="comment">#这一步容易卡在一直处于建立连接中，ctrl+c断掉，重新再来。用虚拟机来搞环境的话，能不能下载下来全看运气了。如果用的云服务器，很容易git下来fabric-samples项目。</span></span><br><span class="line">git <span class="built_in">clone</span> https://github.com/hyperledger/fabric-samples.git</span><br><span class="line"><span class="built_in">cd</span> fabric-samples</span><br><span class="line">git checkout -b sample v1.4.0</span><br></pre></td></tr></table></figure>
<p>​	以上操作完后，我们会在fabric-samples文件中看到一个first-network项目。</p>
<ol start="2">
<li>
<p>Fabric相关的Docker镜像</p>
<p>这里的操作是为了避免网络原因导致Hyperledger Fabric二进制文件git不下来，下面的操作只进行docker相关的部分。之后我们会选择自己下载Hyperledger Fabric二进制等必须文件，避免在出现网络环境的情况下不知道自己到底哪部份没有成功git或者pull下来。</p>
</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 进入fabric-samples中的script文件夹</span></span><br><span class="line"><span class="built_in">cd</span> /scripts</span><br><span class="line"><span class="comment"># 用#注释掉binaryDownload()函数以及binaryInstall命令，如下图所示。</span></span><br><span class="line">vim bootstrap.sh</span><br><span class="line"><span class="comment"># 必须启动docker才能运行bootstrap.sh脚本，这里docker pull需要一定的时间，网络环境应该不会出现问题。</span></span><br><span class="line">systemctl start docker</span><br><span class="line">./bootstrap.sh</span><br></pre></td></tr></table></figure>
<img src="/2022/01/11/Hyperldeger-Fabric%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/image-20220111230745152.png" class="">
<img src="/2022/01/11/Hyperldeger-Fabric%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/image-20220111231035328.png" class="">
<h4 id="bootstrap-sh脚本运行失败解决方法">bootstrap.sh脚本运行失败解决方法</h4>
<ul>
<li>
<p>下载相关Docker镜像</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 下载Fabric相关镜像（fabric-peer、fabric-orderer、fabric-ccenv、fabric-tools），此处以fabric-peer镜像为例，其他镜像同理</span></span><br><span class="line">docker pull hyperledger/fabric-peer:1.4.0</span><br><span class="line">docker tag hyperledger/fabric-peer:1.4.0 hyperledger/fabric-peer:latest</span><br><span class="line"></span><br><span class="line"><span class="comment"># 下载Fabric第三方镜像（fabric-couchdb、fabric-kafka、fabric-zookeeper），此处以fabric-couchdb为例，其他镜像同理</span></span><br><span class="line">docker pull hyperledger/fabric-couchdb:0.4.14</span><br><span class="line">docker tag hyperledger/fabric-couchdb:0.4.14 hyperledger/fabric-couchdb:latest</span><br><span class="line"></span><br><span class="line"><span class="comment"># 下载Fabric CA镜像</span></span><br><span class="line">docker pull hyperledger/fabric-ca:1.4.0</span><br><span class="line">docker tag hyperledger/fabric-ca:1.4.0 hyperledger/fabric-ca:latest</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>（可选）镜像的备份与恢复（我没用过）</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将上述Docker镜像存储到fabric-images文件中</span></span><br><span class="line">docker save $(docker images | grep fabric | grep latest | awk <span class="string">&#x27;&#123;print $1&#125;&#x27;</span>) -o fabric-images</span><br><span class="line"><span class="comment"># 若需要多机部署，则通过下列命令将其分发到其他机器</span></span><br><span class="line">scp fabric-images ubuntu@192.168.70.21:~</span><br><span class="line"><span class="comment"># 在192.168.70.21上加载上述镜像</span></span><br><span class="line">docker load -o fabric-images</span><br></pre></td></tr></table></figure>
</li>
</ul>
<ol start="3">
<li>
<p>下载Fabric二进制文件</p>
<p>这里的v1.4.0只是网上的一个大众选择，可以从官方github上找到最新的版本下载。同时，这里下载的Hyperledger Fabric二进制文件和CA证书会出现连接不到github的现象，这里可以多次运行一下的wget指令。（具体什么时候能连接上全看网络环境和运气orz）</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /resource</span><br><span class="line">wget https://github.com/hyperledger/fabric/releases/download/v1.4.0/hyperledger-fabric-linux-amd64-1.4.0.tar.gz</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">wget https://github.com/hyperledger/fabric-ca/releases/download/v1.4.0/hyperledger-fabric-ca-linux-amd64-1.4.0.tar.gz</span><br><span class="line"></span><br><span class="line">tar xzvf hyperledger-fabric-linux-amd64-1.4.0.tar.gz -C <span class="variable">$GOPATH</span>/src/github.com/hyperledger/fabric-samples/</span><br><span class="line">tar xzvf hyperledger-fabric-ca-linux-amd64-1.4.0.tar.gz -C <span class="variable">$GOPATH</span>/src/github.com/hyperledger/fabric-samples/</span><br><span class="line"></span><br><span class="line"><span class="comment">#向/etc/profile中写入环境变量</span></span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$GOROOT</span>/bin:<span class="variable">$GOPATH</span>/src/github.com/hyperledger/fabric-samples/bin</span><br><span class="line"></span><br><span class="line"><span class="comment">#使环境变量生效</span></span><br><span class="line"><span class="built_in">source</span> /etc/profile</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="启动first-network样例">启动first-network样例</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> <span class="variable">$GOPATH</span>/src/github.com/hyperledger/fabric-samples/first-network</span><br><span class="line"><span class="comment"># 编译通过Golang开发的chaincode并启动相关的容器</span></span><br><span class="line">启动（过程比较长，可能需要几分钟）</span><br><span class="line">./byfn.sh up   </span><br><span class="line"></span><br><span class="line"><span class="comment">#停止first-network网络中所有的容器，删除crypto材料和4个artifacts（genesis.block、mychannel.block、Org1MSPanchor.tx、Org2MSPanchor.tx）以及chaincode镜像</span></span><br><span class="line">./byfn.sh down   <span class="comment">#请不要随便使用该命令</span></span><br></pre></td></tr></table></figure>
<p>​	出现和如下图所示的语句，即证明环境搭建成功~</p>
<img src="/2022/01/11/Hyperldeger-Fabric%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/image-20220111234616111.png" class="">

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/01/11/Hyperldeger-Fabric%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/" data-id="cm1gj9h060003m0ve9otofvag" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  


</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/09/">九月 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/06/">六月 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/05/">五月 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/07/">七月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/03/">三月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">一月 2022</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2024/09/24/Hot100-Day1/">(no title)</a>
          </li>
        
          <li>
            <a href="/2024/06/02/Rust-Warp%E5%A4%84%E7%90%86HTTP%E8%AF%B7%E6%B1%82/">Rust Warp处理HTTP请求</a>
          </li>
        
          <li>
            <a href="/2024/06/02/HTTP%E8%AF%B7%E6%B1%82%E5%86%85%E5%AE%B9/">HTTP请求内容</a>
          </li>
        
          <li>
            <a href="/2024/05/11/Rust%E5%8D%95%E9%93%BE%E8%A1%A8/">Rust单链表</a>
          </li>
        
          <li>
            <a href="/2022/07/10/%E4%BB%A5%E5%A4%AA%E5%9D%8A%E6%B5%8B%E8%AF%95%E7%BD%91%E7%BB%9CRinkeby%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/">以太坊测试网络Rinkeby使用教程</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2024 Zexin Wang<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>